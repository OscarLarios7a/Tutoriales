/*1342655975,176820406*/

if (window.CavalryLogger) { CavalryLogger.start_js(["8DP7E"]); }

__d("DragDropFileUpload",[],function(a,b,c,d,e,f){f.isSupported=function(){return typeof(FileList)!=="undefined";};});
__d("ArbiterDragDrop",["Arbiter","DragDropFileUpload"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DragDropFileUpload'),i='dnd/drag/in',j='dnd/drag/out',k='dnd/drag/drop',l=false,m=function(){if(l)return;l=true;if(!h.isSupported())return;if(!document.addEventListener)return;var o=0;document.addEventListener('dragenter',function(r){if(o===0)g.inform(i,r,g.BEHAVIOR_EVENT);o++;},false);document.addEventListener('dragleave',function(r){o--;if(o===0)g.inform(j,r,g.BEHAVIOR_EVENT);},false);document.addEventListener('drop',function(r){g.inform(k,r,g.BEHAVIOR_EVENT);r.preventDefault();},false);document.addEventListener('dragover',function(r){r.preventDefault();},false);var p=null,q=function(){o=0;g.inform(j,null,g.BEHAVIOR_EVENT);};document.addEventListener('dragover',function(r){p&&window.clearTimeout(p);p=window.setTimeout(q,839);},true);},n=function(o){m();return o;};e.exports={dragEnter:n.bind(null,i),dragLeave:n.bind(null,j),dragDrop:n.bind(null,k)};});
__d("css_on_global_drag",["ArbiterDragDrop","Arbiter","CSS"],function(a,b,c,d,e,f){var g=b('ArbiterDragDrop'),h=b('Arbiter'),i=b('CSS');e.exports=function(j,k){var l=h.subscribe(g.dragEnter(),i.addClass.bind(i,j,k),h.SUBSCRIBE_NEW),m=h.subscribe(g.dragLeave(),i.removeClass.bind(i,j,k),h.SUBSCRIBE_NEW);return function(){l.unsubscribe();m.unsubscribe();};};});
__d("DragDropTarget",["event-extensions","CSS","DragDropFileUpload","copyProperties","css_on_global_drag"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DragDropFileUpload'),i=b('copyProperties'),j=b('css_on_global_drag');function k(l,m){this.element=l;this.preprocess=function(n){return n;};this.onDrop=m;this._listeners=[];}i(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},activate:function(){if(!h.isSupported())return;var l=j(this.element,'fbWantsDragDrop'),m=0;this._listeners.push(Event.listen(this.element,'dragenter',function(){if(m===0)g.addClass(this.element,'fbDropReady');m++;}.bind(this)));var n=g.removeClass.bind(g,this.element,'fbDropReady');this._listeners.push(Event.listen(this.element,'dragleave',function(){m=Math.max(m-1,0);if(m===0)n();}.bind(this)));this._listeners.push(Event.listen(this.element,'dragover',function(o){Event.kill(o);}));this._listeners.push(Event.listen(this.element,'drop',function(o){Event.kill(o);var p=this.preprocess(o.dataTransfer.files);m=0;n();if(p.length)this.onDrop(p);}.bind(this)));},deactivate:function(){while(this._listeners.length)this._listeners.pop().remove();}});e.exports=k;});
__d("FileUploadTarget",["AsyncUploadRequest","DragDropFileUpload","DragDropTarget","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncUploadRequest'),h=b('DragDropFileUpload'),i=b('DragDropTarget'),j=b('copyProperties');function k(l,m){var n=(function(o){var p=new g(m).setFiles({file:o}).setRelativeTo(l).setStatusElement(l);p.subscribe('complete',function(q,r){this.onCompleteCallback(r);}.bind(this));p.send();}).bind(this);this.dragDropTarget=new i(l,(function(o){o.length&&this.asyncProcess(o,function(p){p.length&&n(p);});}).bind(this));this.asyncProcess=function(o,p){p(o);};this.preprocess=function(o){return o;};this.onCompleteCallback=bagofholding;}j(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},setAsyncProcessor:function(l){this.asyncProcess=l;return this;},onComplete:function(l){this.onCompleteCallback=l;return this;},activate:function(){if(!h.isSupported())return;this.dragDropTarget.setPreprocessor(this.preprocess).activate();}});e.exports=k;});
__d("SinglePictureUploadTarget",["Bootloader","Dialog","ErrorDialog","FileUploadTarget","StringEscape","tx","copyProperties"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Dialog'),i=b('ErrorDialog'),j=b('FileUploadTarget'),k=b('StringEscape'),l=b('tx'),m=b('copyProperties');function n(o,p){this.fileUploadTarget=new j(o,p);this.preprocessCallback=bagofholding;this.oncompleteCallback=bagofholding;this.afterSuccessCallback=bagofholding;this.maxWidth=null;this.maxHeight=null;}m(n.prototype,{setPreprocessCallback:function(o){this.preprocessCallback=o;return this;},setOncompleteCallback:function(o){this.oncompleteCallback=o;return this;},setAfterSuccessCallback:function(o){this.afterSuccessCallback=o;return this;},setMaximumDimensions:function(o,p){this.maxWidth=o;this.maxHeight=p;return this;},activate:function(){var o=function(s){return k.htmlSpecialChars(s.name);},p=(function(s){if(s.length>1){i.show("Error de Carga",l._("S\u00f3lo puedes seleccionar {max-photos} para cargarlas en este \u00e1lbum. \u00danicamente se cargar\u00e1n las {max-photos} primeras fotos seleccionadas.",{'max-photos':1}));s=[s[0]];}var t=s[0];if(!t.type.match(/^image\//)){i.show("Error de Carga",l._("No pudimos acceder al contenido de {filename}. Aseg\u00farate de que es una imagen con formato jpg, gif o png.",{filename:o(t)}));return [];}this.preprocessCallback(s);return s;}).bind(this),q=(function(s,t){var u=1024*1024*16,v=1024*1024*1,w=function(y){if(y.size>u){i.show("Error de Carga",l._("{filename} es demasiado grande. Cambia el tama\u00f1o de la foto a menos de 8000x8000 pixeles y vuelve a intentarlo.",{filename:o(s[0])}));t([]);}else t([y]);},x=s[0];if((x.size<v)||(!this.maxWidth&&!this.maxHeight)){w(x);}else g.loadModules(['ImageExif','ImageResizer'],function(y,z){if(!z.isSupported()){w(x);return;}var aa=new z(x,this.maxWidth,this.maxHeight);aa.subscribe('resized',function(ba,ca){if(ca.size>x.size){w(x);}else w(ca);}.bind(this));aa.subscribe('error',function(){w(x);}.bind(this));y.readFromFile(x,function(ba){ba&&aa.setOrientation(ba.Orientation);aa.resize();});});}).bind(this),r=(function(s){var t=s[0];this.oncompleteCallback(t);var u=t.getResponse().getPayload();if(t.isSuccess()){this.afterSuccessCallback(u);}else if(u&&u.__dialog){var v=new h();v._setFromModel(u.__dialog);v.setButtons(h.OK).show();}else i.show(u.error.title,u.error.body);}).bind(this);return this.fileUploadTarget.onComplete(r).setPreprocessor(p).setAsyncProcessor(q).activate();}});e.exports=n;});
__d("TimelineProfilePic",["Arbiter","CSS","Dialog","DOM","HTML","Run","$","ge","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('HTML'),l=b('Run'),m=b('$'),n=b('ge'),o=b('copyProperties');function p(q,r,s,t){p.destroyInstance();p._instance=this;this.leavingMessage=r;this.elemID=s||'fbProfileCover';this.elemClass=t||'.profilePicThumb';this._arbiterTokens=[g.subscribe(q.LOADING,this.startLoading.bind(this)),g.subscribe(q.SUCCESS,this.onUploadSuccess.bind(this))];l.onBeforeUnload(this.onBeforeUnload.bind(this));l.onLeave(this.destroy.bind(this));}o(p,{_instance:null,destroyInstance:function(){this._instance&&this._instance.destroy();}});o(p.prototype,{_setLoadingIndicator:function(q){this._loading=q;h.conditionClass(j.find(m(this.elemID),this.elemClass),'profilePicLoading',q);},destroy:function(){this._arbiterTokens.forEach(function(q){q.unsubscribe();});this._arbiterTokens=[];p._instance=null;},startLoading:function(q,r){this._setLoadingIndicator(r.isLoading);if(n('fbProfilePicSelector'))h.removeClass(m('fbProfilePicSelector'),'fbTimelineNullProfilePicSelector');},onUploadSuccess:function(q,r){this._setLoadingIndicator(false);var s=i.getCurrent();if(s)s.hide();j.replace(j.find(m(this.elemID),this.elemClass),k(r.newPic));if(typeof(r.profileId)!==undefined&&typeof(r.headerPicURL)!==undefined){var t=n('profile_pic_header_'+r.profileId);if(t)t.src=r.headerPicURL;}},onBeforeUnload:function(){if(p._instance===this&&this._loading)return this.leavingMessage;}});e.exports=p;});
__d("timeline-cover-dragdrop-edit",["SinglePictureUploadTarget","TimelineCover"],function(a,b,c,d,e,f){var g=b('SinglePictureUploadTarget'),h=b('TimelineCover'),i=function(){var m=h.getInstance();m.hideLoadingIndicator();},j=function(m){var n=h.getInstance(),o=m.id,p=m.photo_html;n.updateCoverImage(o,p);},k=function(m){h.getInstance().showLoadingIndicator();},l=function(m,n,o,p){new g(m,n).setMaximumDimensions(o,p).setPreprocessCallback(k).setOncompleteCallback(i).setAfterSuccessCallback(j).activate();};f.initialize_timeline_cover_drop_target=l;});
__d("profile-pic-dragdrop-edit",["Arbiter","SinglePictureUploadTarget","TimelineProfilePic"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('SinglePictureUploadTarget'),i=b('TimelineProfilePic');f.initialize_profile_pic_drop_target=function(j,k,l,m){new i(l,m);new h(j,k).setPreprocessCallback(function(n){g.inform(l.LOADING,{isLoading:1},g.BEHAVIOR_STATE);}).setOncompleteCallback(function(){g.inform(l.LOADING,{isLoading:0},g.BEHAVIOR_STATE);}).setAfterSuccessCallback(function(n){g.inform(l.SUCCESS,{newPic:n.photo_html},g.BEHAVIOR_STATE);}).activate();};});
function FutureProfileSideNav(){this.parent.construct(this);}Class.extend(FutureProfileSideNav,'FutureSideNav');copy_properties(FutureProfileSideNav.prototype,{init:function(){this.parent.init.apply(this,arguments);this.ajaxPipe=true;this.altKeyParam='v';this.sidecol=false;},_constructItem:function(a,b){return new FutureProfileSideNavItem(a,b);},_doPageTransition:function(a,b){if(!this._profileChanged(b)&&!this._scopeChanged(a))return this.parent._doPageTransition(a,b);},_profileChanged:function(a){var b=a.getQueryData(),c=this.uri.getQueryData();return (b.id!==c.id||b.viewas!==c.viewas||b.and!==c.and);},_scopeChanged:function(a){return (!this.selected||a.layoutType!==this.selected.layoutType);},_getKey:function(a){return this.parent._getKey(a)||a[this.altKeyParam];}});function FutureProfileSideNavItem(a,b){this.parent.construct(this,a,b);this.layoutType=a.layouttype;}Class.extend(FutureProfileSideNavItem,'FutureSideNavItem');
__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["event-extensions","function-extensions","Arbiter","AsyncRequest","CSS","DOM","ge","Menu","Parent","SubscriptionLevels"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('ge'),l=b('Menu'),m=b('Parent'),n=b('SubscriptionLevels'),o=13,p=45,q=[n.ALL,n.DEFAULT,n.TOP],r={},s={},t={},u={},v={},w={},x={},y={},z={},aa={},ba="/ajax/follow/follow_profile.php",ca="/ajax/follow/unfollow_profile.php",da={},ea={},fa=null;function ga(ab){return q.contains(ab);}function ha(ab,bb,cb,db){var eb=m.byClass(db,'uiMenuItem')||m.byClass(db,'uiMenuXItem');if(!eb||!j.contains(ab,eb)){return;}else if(i.hasClass(eb,'SubscribeMenuSubscribeCheckbox')){if(t[bb]){ka(ab,bb);}else ja(ab,bb);return false;}else if(i.hasClass(eb,'SubscribeMenuUnsubscribe')){ka(ab,bb);return false;}else if(i.hasClass(eb,'SubscribeMenuSettingsItem')){xa(ab,true);return false;}else if(i.hasClass(eb,'SubscriptionMenuGoBack')){xa(ab,false);return false;}else if(i.hasClass(eb,'SubscriptionMenuItem')){ia(ab,bb,cb,eb);return false;}}function ia(ab,bb,cb,db){if(i.hasClass(db,'SubscriptionMenuLevel')){if(l.isItemChecked(db))return;va(ab,bb,oa(db),true,cb);}else if(i.hasClass(db,'SubscriptionMenuCategory')){sa(bb,db,!l.isItemChecked(db),true,cb);}else if(i.hasClass(db,'SubscriptionAppStory'))ua(bb,db,!l.isItemChecked(db),cb);}function ja(ab,bb){var cb={profile_id:bb};g.inform('FollowingUser',cb);new h().setURI(ba).setMethod('POST').setData({profile_id:bb,location:la(ab)}).setErrorHandler(g.inform.curry('FollowUserFail',cb)).send();}function ka(ab,bb){var cb={profile_id:bb};g.inform('UnfollowingUser',cb);new h().setURI(ca).setMethod('POST').setData({profile_id:bb,location:la(ab)}).setErrorHandler(g.inform.curry('UnfollowUserFail',cb)).send();}function la(ab){if(i.hasClass(ab,'followButtonFlyout')){return o;}else return p;}function ma(ab,bb,cb){var db={profile_id:ab,level:x[ab],custom_categories:y[ab],location:cb};new h().setURI('/ajax/follow/manage_subscriptions.php').setData(db).send();}function na(ab,bb){var cb=y[bb]||[],db=l.getItems(ab);db.forEach(function(eb){if(i.hasClass(eb,'SubscriptionMenuCategory')){var fb=oa(eb);if(cb.contains(fb)){qa(eb);}else ra(eb);}else if(i.hasClass(eb,'SubscriptionAppStory')){var gb=oa(eb);if(ea[bb]&&ea[bb][gb]){qa(eb);}else ra(eb);}});va(ab,bb,x[bb],false);}function oa(ab){var bb=j.scry(ab,'input')[0];return bb&&bb.value;}function pa(ab){return j.find(ab,'a.itemAnchor');}function qa(ab){i.addClass(ab,'checked');pa(ab).setAttribute('aria-checked',true);}function ra(ab){i.removeClass(ab,'checked');pa(ab).setAttribute('aria-checked',false);}function sa(ab,bb,cb,db,eb){if(cb){qa(bb);}else ra(bb);var fb=oa(bb);if(ga(fb)){cb&&ta(ab,fb);}else if(cb){if(!y[ab].contains(fb))y[ab].push(fb);}else{var gb=y[ab].indexOf(fb);if(gb!==-1)y[ab].splice(gb,1);}if(db)ma(ab,fb,eb);}function ta(ab,bb){x[ab]=bb;g.inform('SubscriptionLevelUpdated',{profile_id:ab,level:bb});}function ua(ab,bb,cb,db){var eb='/ajax/feed/filter_action/',fb=oa(bb),gb={actor_id:ab,app_id:fb};if(cb){qa(bb);eb+='resubscribe_user_app/';gb.action='resubscribe_user_app';if(!ea[ab])ea[ab]={};ea[ab][fb]=true;}else{ra(bb);eb+='unsubscribe_user_app_checkbox/';gb.action='unsubscribe_user_app_checkbox';if(ea[ab])ea[ab][fb]=false;}new h().setURI(eb).setData(gb).send();}function va(ab,bb,cb,db,eb){var fb=j.scry(ab,'.SubscriptionMenuLevel'),gb=null;fb.forEach(function(hb){if(oa(hb)==cb){gb=hb;}else if(l.isItemChecked(hb))sa(bb,hb,false,false);});gb&&sa(bb,gb,true,db,eb);}function wa(ab,bb,cb){t[bb]=cb;i.conditionClass(ab,'isUnsubscribed',!cb);var db=j.scry(ab,'li.SubscribeMenuSubscribeCheckbox');if(db.length!==0){var eb=db[0];if(cb){qa(eb);}else ra(eb);}}function xa(ab,bb){i.conditionClass(ab,'subscriptionMenuOpen',bb);}function ya(ab,bb,cb){var db=j.find(ab,".FriendListSubscriptionsMenu"),eb=j.find(db,".uiMenuInner");if(fa!=null)fa.forEach(function(fb){eb.removeChild(fb);});cb.forEach(function(fb){eb.appendChild(fb);});fa=cb;}g.subscribe('UnfollowUser',function(ab,bb){if(z[bb.profile_id]){ta(bb.profile_id,z[bb.profile_id]);y[bb.profile_id]=aa[bb.profile_id].slice();}});g.subscribe('UpdateSubscriptionLevel',function(ab,bb){var cb=bb.profile_id+'',db=bb.level+'';ta(cb,db);var eb;for(eb in r)if(r[eb]===cb){var fb=k(eb);fb&&va(fb,cb,db,false);}});var za={init:function(ab,bb,cb){var db=j.getID(ab);if(!r[db])Event.listen(ab,'click',function(eb){return ha(ab,r[db],cb,eb.getTarget());});if(cb===p&&da[bb].length)ya(ab,bb,da[bb]);if(x[bb])na(ab,bb);r[db]=bb;i.conditionClass(ab,'NonFriendSubscriptionMenu',!s[bb]);i.conditionClass(ab,'cannotSubscribe',!u[bb]);i.conditionClass(ab,'noSubscriptionLevels',v[bb]&&!w[bb]);i.conditionClass(ab,'noSubscribeCheckbox',!s[bb]&&!v[bb]);wa(ab,bb,t[bb]);g.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(eb,fb){wa(ab,bb,true);}.bind(this));g.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(eb,fb){g.inform('SubMenu/Reset');wa(ab,bb,false);}.bind(this));xa(ab,false);},getSubscriptions:function(ab){return {level:x[ab],custom_categories:y[ab]};},setSubscriptions:function(ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb){ta(ab,gb+'');s[ab]=bb;t[ab]=cb;u[ab]=db;v[ab]=eb;w[ab]=fb;z[ab]=ib+'';y[ab]=hb.map(String);aa[ab]=jb.map(String);da[ab]=kb;}};e.exports=a.EditSubscriptions||za;});
__d("DynamicFriendListEducation",["event-extensions","Arbiter","AsyncRequest","Dialog","PageTransitions","createArrayFrom"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Dialog'),j=b('PageTransitions'),k=b('createArrayFrom'),l,m,n,o,p,q;function r(){n&&n.hide();o&&o.hide();}function s(v){m.remove(v);r();p({accept_tag_education:true});}function t(){r();p({nux_cancel:true});}var u={init:function(v,w){l=v;m=k(w).map(String);j.registerHandler(function(){r();l=false;p=undefined;m=[];});},showDialog:function(v,w,x){if(l&&m.contains(v)){r();g.inform('DynamicFriendListEducation/dialogOpen',{uid:w,flid:v});p=x;n=new i().setAsync(new h('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true)).setHandler(s.bind(this,v)).setCloseHandler(function(){g.inform('DynamicFriendListEducation/dialogClosed',{uid:w,flid:v});}).setCancelHandler(function(){g.inform('DynamicFriendListEducation/dialogCancel',{uid:w,flid:v});}).show();}else x();},showContextualDialog:function(v,w,x,y){if(l&&m.contains(v)){r();q=x;p=y;new h('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true).send();}else y();},setContextualDialog:function(v,w,x,y){o=v;o.setContext(q);o.show();Event.listen(w,'click',s.bind(this,y));Event.listen(x,'click',t);}};e.exports=u;});
__d("FriendStatus",["array-extensions","function-extensions","Arbiter","AsyncRequest","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){b('array-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('copyProperties'),j=b('createArrayFrom');function k(o,p,q){this.id=o;this.update(p,q);}i(k.prototype,{update:function(o,p){o&&(this.status=o);if(p){this.lists=j(p).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(o){if(this.lists&&!this.lists.contains(o))this.lists.push(o);this._informListChange();},removeFromList:function(o){if(this.lists){var p=this.lists.indexOf(o);p!==-1&&this.lists.splice(p,1);}this._informListChange();},updateList:function(o,p){p?this.addToList(o):this.removeFromList(o);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});i(k,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var l={},m={};function n(o,p,q){if(!l[q.uid]){l[q.uid]=new k(q.uid,o);}else l[q.uid].update(o);g.inform('FriendRequest/change',{uid:q.uid,status:o});}g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],n.curry(k.CAN_REQUEST));g.subscribe(['FriendRequest/confirmFail'],n.curry(k.INCOMING_REQUEST));g.subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],n.curry(k.OUTGOING_REQUEST));g.subscribe(['FriendRequest/confirm','FriendRequest/confirming'],n.curry(k.ARE_FRIENDS));i(k,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(o,p){if(l[o]&&l[o].isComplete()){p(l[o]);}else if(m[o]){m[o].push(p);}else{m[o]=[p];new h().setURI("/ajax/friends/status.php").setData({friend:o}).setHandler(function(q){var r=q.getPayload();k.initFriend.bind(k,o,r.status,r.lists).defer();}).send();}},initFriend:function(o,p,q){var r=l[o]||new k(o);r.update(r.status||p,r.lists||q);l[o]=r;m[o]&&m[o].forEach(function(s){s(r);});m[o]=null;},setSpecialLists:function(o){k.CLOSE_FRIENDS=o.close+'';k.ACQUAINTANCES=o.acq+'';}});e.exports=k;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","FriendStatus","Menu","Parent","ScrollableArea","URI","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('FriendStatus'),n=b('Menu'),o=b('Parent'),p=b('ScrollableArea'),q=b('URI'),r=b('$'),s=b('copyProperties'),t=b('ge'),u=5,v={},w="/ajax/profile/removefriendconfirm.php",x='/ajax/friends/requests/cancel.php',y='/ajax/friend_suggester_dialog.php',z;function aa(ja,ka,la){var ma=v[ja.id],na=function(oa){var pa={action:la?'add_list':'del_list',to_friend:ma.id,friendlists:[ka],source:z};if(oa)s(pa,oa);ma.updateList(ka,la);var qa;if(la&&ka==m.CLOSE_FRIENDS){qa=da(ja,m.ACQUAINTANCES);if(n.isItemChecked(qa)){n.toggleItem(qa);aa(ja,m.ACQUAINTANCES,false);}}else if(la&&ka==m.ACQUAINTANCES){qa=da(ja,m.CLOSE_FRIENDS);if(n.isItemChecked(qa)){n.toggleItem(qa);aa(ja,m.CLOSE_FRIENDS,false);}}var ra={flid:ka,uid:ma.id},sa=la?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(sa,ra);new h().setURI('/ajax/add_friend/action.php').setData(pa).send();};if(la){k.showDialog(ka,ma.id,na);}else na();}function ba(ja){var ka=j.scry(ja,'input')[0];return ka&&ka.value;}function ca(ja,ka,la){var ma={uid:ka.id};new h().setURI(x).setMethod('POST').setData({friend:ka.id}).setHandler(g.inform.bind(g,'FriendRequest/cancel',ma)).setErrorHandler(g.inform.bind(g,'FriendRequest/cancelFail',ma)).setStatusElement(la).send();}function da(ja,ka){var la=n.getItems(ja);for(var ma=0;ma<la.length;ma++)if(ba(la[ma])==ka)return la[ma];return null;}function ea(ja,ka){var la=n.getItems(ja);la.forEach(function(ma){var na=ba(ma),oa=ka.lists.contains(na);if(n.isItemChecked(ma)!==oa)n.toggleItem(ma);});}function fa(ja){var ka=n.getItems(ja),la=!i.hasClass(ja,'followButtonFlyout')&&!i.hasClass(ja,'likeButtonFlyout'),ma=[],na=[],oa=0,pa=0;ka.forEach(function(ua){if(i.hasClass(ua,'neverHide')){i.removeClass(ua,'underShowMore');oa++;}else if(n.isItemChecked(ua)){ma.push(ua);}else if(i.hasClass(ua,'neverShow')||i.hasClass(ua,'FriendListCreateTrigger')||(!la&&i.hasClass(ua,'friendOptionsOnly'))){i.addClass(ua,'underShowMore');pa++;}else na.push(ua);});var qa=u-oa,ra=ma.concat(na),sa=pa;ra.forEach(function(ua){if(i.hasClass(ua,'ShowMoreItem')){qa--;return;}if(qa){i.removeClass(ua,'underShowMore');qa--;}else{i.addClass(ua,'underShowMore');sa=true;}});i.conditionClass(ja,'hasMoreFriendListItems',sa);var ta=j.scry(ja,'.FriendListMenuShowMore');ta.forEach(function(ua){i.removeClass(ua,'FriendListMenuShowMore');});}function ga(ja,ka){var la=j.scry(ja,'.FriendListUnfriend')[0],ma=j.scry(ja,'.FriendListCancel')[0],na=j.scry(ja,'.FriendListSuggestFriends')[0];if(ma)i.conditionShow(ma,ka.status==m.OUTGOING_REQUEST);if(la){i.conditionShow(la,ka.status==m.ARE_FRIENDS);j.find(la,'a').setAttribute('ajaxify',q(w).addQueryData({uid:ka.id}).toString());}if(na)j.find(na,'a').setAttribute('href',q(y).addQueryData({newcomer:ka.id,ref:'profile_others_dropdown',close_handler:'null'}).toString());}function ha(ja,ka){var la=j.scry(ja,'div.FriendListSubscriptionsMenu');if(la.length!==0)l.init(ja,ka,45);}g.subscribe('FriendRequest/change',function(ja,ka){for(var la in v){var ma=t(la),na=v[la];if(ma&&na&&na.id==ka.uid){ea(ma,na);ga(ma,na);fa(ma);}}});n.subscribe('select',function(ja,ka){if(i.hasClass(ka.item,'ShowMoreItem')&&i.hasClass(ka.menu,'FriendListMenu')){i.addClass(ka.menu,'FriendListMenuShowMore');p.poke(ka.item);}});var ia={init:function(ja,ka,la){ja=r(ja);z=la;if(!v[ja.id])n.subscribe('select',function(ma,na){if(j.contains(ja,na.item))if(o.byClass(na.item,'FriendListItem')){n.toggleItem(na.item);var oa=ba(na.item);aa(ja,oa,n.isItemChecked(na.item));}else if(o.byClass(na.item,'FriendListCancel')){ca(ja,v[ja.id],na.item);}else if(o.byClass(na.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ja,'async_saving');m.getFriend(ka,function(ma){ea(ja,ma);ga(ja,ma);v[ja.id]=ma;fa(ja);ha(ja,ka);i.removeClass(ja,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||ia;});
__d("FriendListFlyoutController",["event-extensions","Arbiter","AsyncRequest","Button","CSS","DataStore","Dialog","DOM","FriendEditLists","FriendStatus","Layer","Parent","ScrollableArea","Style","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Button'),j=b('CSS'),k=b('DataStore'),l=b('Dialog'),m=b('DOM'),n=b('FriendEditLists'),o=b('FriendStatus'),p=b('Layer'),q=b('Parent'),r=b('ScrollableArea'),s=b('Style'),t=b('UserAgent'),u,v,w=null,x=null,y,z,aa,ba,ca,da,ea=1500,fa={init:function(sa){fa.init=bagofholding;u=sa;u.subscribe('mouseenter',ga);u.subscribe('mouseleave',na);u.subscribe('hide',ha);if(w)m.setContent(u.getContent(),[w,x]);var ta=function(ua){var va=q.byClass(ua.getTarget(),'enableFriendListFlyout');if(va)if(y===va){clearTimeout(ba);}else{v&&pa();ma(va);}};Event.listen(document.documentElement,{mouseover:ta,click:ta});g.subscribe('FriendEditLists/unfriend',pa);g.subscribe('DynamicFriendListEducation/dialogOpen',function(){da=true;});g.subscribe('DynamicFriendListEducation/dialogClosed',function(){da=false;na();});},initContent:function(sa){m.appendContent(document.body,sa);(function(){if(!w){w=sa;u&&m.setContent(u.getContent(),[w,x]);j.show(w);Event.listen(w,'click',qa);v&&ka(y);}else{m.remove(sa);sa=null;}}).defer();},initNux:function(sa){if(x)return;x=sa;u&&m.setContent(u.getContent(),[w,x]);},show:function(sa){la(sa);},hide:function(sa){sa===false?pa():na();},setActiveNode:function(sa){v&&pa();y=sa;z=Event.listen(sa,'mouseleave',function(){y=null;z&&z.remove();});},setCloseListener:function(sa,ta){k.set(sa,'flfcloselistener',ta);if(y!=sa)k.set(sa,'flfcloselistenertimeout',ra.curry(sa).defer(ea));},setCloseListenerTimeout:function(sa){ea=sa;}};function ga(){clearTimeout(ba);}function ha(){if(y){j.removeClass(y,'selected');j.removeClass(y,'uiButtonHover');if(k.get(y,'flfcloselistener')){var sa=y;k.set(y,'flfcloselistenertimeout',ra.curry(sa).defer(ea));}}v=false;ja();y=null;}function ia(sa){if(m.isNodeOfType(sa,'label')&&j.hasClass(sa,'uiButton'))sa=i.getInputElement(sa);return k.get(sa,'profileid');}function ja(){z&&z.remove();z=null;ca&&p.unsubscribe(ca);ca=null;ba&&clearTimeout(ba);ba=null;}function ka(sa){var ta=ia(sa),ua=k.get(sa,'flloc');n.init(w,ta,ua);j.conditionClass(w,'followButtonFlyout',j.hasClass(sa,'profileFollowButton'));j.conditionClass(w,'friendButtonFlyout',j.hasClass(sa,'FriendRequestFriends')||j.hasClass(sa,'FriendRequestIncoming')||j.hasClass(sa,'FriendRequestOutgoing'));j.conditionClass(w,'likeButtonFlyout',j.hasClass(sa,'profileLikeButton'));var va=m.scry(w,'div.uiScrollableArea')[0];va&&r.poke(va);}function la(sa){if(!u||v)return;u.setContext(sa);u.setCausalElement(sa);sa.setAttribute('aria-expanded','true');j.addClass(sa,'selected');j.addClass(sa,'uiButtonHover');u.show();y=sa;v=true;if(w){ka(sa);}else new h().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(u.getContent()).send();ja();z=Event.listen(sa,'mouseleave',na);ca=p.subscribe('show',pa);if(k.get(sa,'flfcloselistener'))clearTimeout(k.remove(sa,'flfcloselistenertimeout'));var ta=ia(sa);o.getFriend(ta,function(ua){if(!x)return;if(ua.status==o.OUTGOING_REQUEST){j.show(x);h.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else j.hide(x);});}function ma(sa){y=sa;aa=la.curry(sa).defer(350);z=Event.listen(sa,'mouseleave',function(){clearTimeout(aa);y=null;z&&z.remove();});}function na(){ba=pa.defer(150);}function oa(){var sa=l.getCurrent(),ta=sa&&sa.getBody();return !!(ta&&m.scry(ta,'.friendListDialogTourCarousel')[0]);}function pa(){if(da||oa())return;t.ie()<8&&document.documentElement.focus();if(u){u.hide();var sa=u.getCausalElement();sa&&sa.setAttribute('aria-expanded','false');}}function qa(event){var sa=q.byTag(event.getTarget(),'a');if(sa&&j.hasClass(sa,'FriendListActionItem'))na();}function ra(sa){var ta=k.remove(sa,'flfcloselistener');ta&&ta();}e.exports=a.FriendListFlyoutController||fa;});
__d("legacy:FriendListFlyoutController",["FriendListFlyoutController"],function(a,b,c,d){a.FriendListFlyoutController=b('FriendListFlyoutController');},3);
__d("legacy:FriendStatus",["FriendStatus"],function(a,b,c,d){a.FriendStatus=b('FriendStatus');},3);
__d("legacy:dom-collect",["collectDataAttributes"],function(a,b,c,d){a.collect_data_attribs=b('collectDataAttributes');},3);
var AddFriendButton={ERROR_ALREADY_ADDED:1431005,init:function(a,b,c,d,e,f,g,h,i,j,k){var l=null,m=DOM.scry(a,'.addButton')[0],n=DOM.scry(a,'.outgoingButton')[0],o=DOM.scry(a,'.incomingButton')[0],p=DOM.scry(a,'.friendButton')[0];function q(w,x,y){var z=new URI(m.getAttribute('ajaxify'));link_data=collect_data_attribs(a,['ft','gt']);new AsyncRequest().setURI(f).setData({to_friend:b,action:w,how_found:d,ref_param:e,link_data:link_data,outgoing_id:n.id,xids:z.getQueryData().xids,logging_location:g,no_flyout_on_click:h,ego_log_data:i,http_referer:k}).setErrorHandler(x).setServerDialogCancelHandler(y).setRelativeTo(n).send();}function r(w,x){m&&CSS.hide(m);n&&CSS.hide(n);o&&CSS.hide(o);p&&CSS.hide(p);if(w)CSS.show(w);if('Outgoing'==x&&l!=x&&j)animation(w).from('backgroundColor','#FFF8CC').to('backgroundColor','transparent').from('borderColor','#FFE222').to('borderColor',CSS.getStyle(w,'borderLeftColor')).duration(2000).go();l&&CSS.removeClass(a,'fStatus'+l);l=x;CSS.addClass(a,'fStatus'+x);}function s(w){if(CSS.hasClass(w,'enableFriendListFlyout')){FriendListFlyoutController.show(w);}else FriendListFlyoutController.hide();}function t(w){var x='/pymksearch/';new AsyncRequest().setURI(x).setHandler(function(y){var z=y.getPayload();if(z==null)return;var aa=DOM.find(w,'^.detailedsearch_result');CSS.addClass(aa,"-cx-PRIVATE-chainedPYMK__chainedresult");DOM.insertAfter(aa,z);}).send();}var u=Arbiter.subscribe('FriendRequest/change',function(w,x){if(x.uid!=b)return;switch(x.status){case FriendStatus.ARE_FRIENDS:return r(p,'Friends');case FriendStatus.INCOMING_REQUEST:return r(o,'Incoming');case FriendStatus.OUTGOING_REQUEST:return r(n,'Outgoing');case FriendStatus.CAN_REQUEST:return r(m,'Requestable');}}),v;if(c)v=Arbiter.subscribe('FriendRequest/confirm',function(w,x){x.uid==b&&goURI(c);});m&&Event.listen(m,'click',function(){Arbiter.inform('FriendRequest/sending',{uid:b});if(h){FriendListFlyoutController.setActiveNode(n);}else s(n);q("add_friend",function(w){var x=w.error==AddFriendButton.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';Arbiter.inform(x,{uid:b});FriendListFlyoutController.hide();AsyncResponse.defaultErrorHandler(w);},function(w){Arbiter.inform('FriendRequest/sendFail',{uid:b});FriendListFlyoutController.hide();});if(d=='search')t(n);});PageTransitions.registerHandler(function(){u.unsubscribe();v&&v.unsubscribe();});}};
__d("ContextualDialogArrow",["CSS","DOM","Locale","Style","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Locale'),j=b('Style'),k=b('copyProperties'),l=b('cx'),m=15,n=16,o={bottom:"-cx-PRIVATE-uiContextualDialog__arrowBottom",top:"-cx-PRIVATE-uiContextualDialog__arrowTop",right:"-cx-PRIVATE-uiContextualDialog__arrowRight",left:"-cx-PRIVATE-uiContextualDialog__arrowLeft"},p={above:'bottom',below:'top',left:'right',right:'left'};function q(r){this._layer=r;}k(q.prototype,{_subscription:null,_arrow:null,enable:function(){this._subscription=this._layer.subscribe(['adjust','reposition'],this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(r,s){if(r==='adjust'){this._repositionArrow(s);}else this._repositionRoot(s);},_repositionRoot:function(r){var s=this._layer.getRoot();if(!r.isVertical()){var t=parseInt(j.get(s,'top'),10);t-=m;j.set(s,'top',t+'px');}},_repositionArrow:function(r){var s=this._layer._contentWrapper,t=0,u=r.getAlignment(),v=r.getPosition();if(v=='above'||v=='below')if(u=='center'){t=50;}else if(u=='right')t=100;var w=p[v];for(var x in o)g.conditionClass(s,o[x],w===x);if(v=='none')return;if(!this._arrow){this._arrow=this._drawArrow();h.appendContent(s,this._arrow);}g.conditionClass(s,"-cx-PRIVATE-uiContextualDialog__withFooter",this._layer.getFooter());j.set(this._arrow,'top','');j.set(this._arrow,'left','');j.set(this._arrow,'right','');j.set(this._arrow,'margin','');var y=w=='top'||w=='bottom',z=y?(i.isRTL()?'right':'left'):'top';t=t||0;j.set(this._arrow,z,t+'%');var aa=n+(m*2);j.set(this._arrow,'margin-'+z,-(aa*t/100-m)+'px');},_drawArrow:function(){return h.create('i',{className:"-cx-PRIVATE-uiContextualDialog__arrow"});}});q.OFFSET=m;q.LENGTH=n;e.exports=q;});
__d("ContextualDialogFitInViewport",["event-extensions","ContextualDialogArrow","ContextualLayerDimensions","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ContextualDialogArrow'),h=b('ContextualLayerDimensions'),i=b('Style'),j=b('Vector'),k=b('copyProperties'),l=g.OFFSET,m=g.LENGTH,n=l+m;function o(p){this._layer=p;}k(o.prototype,{_scrollListener:null,_subscription:null,_minimumTop:null,enable:function(){this._subscription=this._layer.subscribe(['show','hide','reposition'],function(p,q){if(p=='reposition'){this._calculateMinimumTop(q);}else if(p=='show'){this._attachScroll();this._adjustForScroll();}else this._detachScroll();}.bind(this));if(this._layer.isShown())this._attachScroll();},disable:function(){if(this._layer.isShown())this._detachScroll();this._subscription.unsubscribe();this._subscription=null;},_attachScroll:function(){this._scrollListener=Event.listen(this._layer.getContextScrollParent()||window,'scroll',this._adjustForScroll.bind(this));},_detachScroll:function(){this._scrollListener.remove();this._scrollListener=null;},_getContentHeight:function(){return j.getElementDimensions(this._layer._contentWrapper).y;},_getContextY:function(){return j.getElementPosition(this._layer.getContext()).y;},_calculateMinimumTop:function(p){if(p.isVertical())return;this._minimumTop=(this._getContextY()-(this._getContentHeight()-n)+p.getOffsetY());},_adjustForScroll:function(){var p=this._layer._getOrientation();if(p.isVertical())return;var q=h.getViewportRect(this._layer),r=q.b-this._minimumTop;if(r<0)return;var s=this._getContentHeight(),t=s-(n+l),u=Math.max(0,Math.min(t,t-(r-s)));i.set(this._layer.getContent(),'top',-u+'px');}});e.exports=o;});
__d("ContextualDialog",["AccessibleLayer","Class","ContextualDialogFitInViewport","ContextualLayer","CSS","DOM","LayerButtons","LayerFormHooks","LayerMouseHooks","Style","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('AccessibleLayer'),h=b('Class'),i=b('ContextualDialogFitInViewport'),j=b('ContextualLayer'),k=b('CSS'),l=b('DOM'),m=b('LayerButtons'),n=b('LayerFormHooks'),o=b('LayerMouseHooks'),p=b('Style'),q=b('copyProperties'),r=b('csx'),s=b('cx');function t(u,v){this.parent.construct(this,u,v);}h.extend(t,j);q(t.prototype,{_footer:null,_configure:function(u,v){u.addedBehaviors.push(u.arrowBehavior);var w=l.scry(v,"div.-cx-PRIVATE-uiContextualDialog__footer");if(w.length)this._footer=w[0];this.parent._configure(u,v);},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([g,i,m,n,o]);},_buildWrapper:function(u,v){k.addClass(v,"-cx-PRIVATE-uiContextualDialog__content");var w=this.parent._buildWrapper(u,v);k.addClass(this._contentWrapper,"-cx-PRIVATE-uiContextualDialog__wrapper");if(u.width)this.setWidth(u.width);return w;},setWidth:function(u){this._width=Math.floor(u);p.set(this._contentWrapper,'width',u+'px');},getFooter:function(){return this._footer;}});q(t,{setContext:function(u,v){u.setContext(v);}});e.exports=t;});
__d("DialogHideOnSuccess",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx');function j(k){this._layer=k;}g(j.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('success',this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(k,event){if(h.hasClass(event.getTarget(),"-cx-PRIVATE-uiDialog__form"))this._layer.hide();}});e.exports=j;});
__d("LayerStopBlur",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this._layer=i;}g(h.prototype,{_subscriptions:null,_onBlur:null,enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attach.bind(this)),this._layer.subscribe('hide',this._detach.bind(this))];if(this._layer.isShown())this._attach();},disable:function(){this._detach();while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;},_detach:function(){this._onBlur&&this._onBlur.unsubscribe();this._onBlur=null;},_attach:function(){(function(){this._onBlur=this._layer.subscribe('blur',function(){return false;});}).bind(this).defer();}});e.exports=h;});
function StreamProfileComposer(){}copy_properties(StreamProfileComposer.prototype,{init:function(a){var b=$(a);Arbiter.subscribe('composer/publish',function(event,c){if(c.streamStory)animation.prependInsert(b,c.streamStory);});}});
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
var SubscribeButton=window.SubscribeButton||(function(){return {SUBSCRIBED:'FollowingUser',UNSUBSCRIBED:'UnfollowingUser',init:function(a,b,c,d){Event.listen(b,'click',function(){Arbiter.inform(SubscribeButton.SUBSCRIBED,{profile_id:d});});Arbiter.subscribe(SubscribeButton.SUBSCRIBED,function(e,f){if(d===f.profile_id)a.swap();});Arbiter.subscribe(SubscribeButton.UNSUBSCRIBED,function(e,f){if(d===f.profile_id){a.unswap();c.hideFlyout();Arbiter.inform('SubMenu/Reset');}});},initUnsubscribe:function(a,b){Event.listen(a,'click',function(){Arbiter.inform.bind(Arbiter,SubscribeButton.UNSUBSCRIBED,{profile_id:b}).defer();});}};})();
function fbpage_set_fan_status(a,b,c,d,e,f,g){e=e?e:function(j){_fbpage_show_change_status_feedback(a,j.getPayload());};var h={fbpage_id:b,add:c,reload:d};if(g!=null)copy_properties(h,g);var i=new AsyncRequest().setURI('/ajax/pages/fan_status.php').setData(h).setNectarModuleDataSafe(a).setHandler(e);if(f)i.setErrorHandler(f);i.send();return false;}function fbpage_set_favorite_status(a,b,c){var d=function(){_fbpage_show_change_status_feedback(a,this.getUserData());},e={fbpage_id:b,add:c},f=new AsyncRequest().setMethod('POST').setURI('/ajax/pages/favorite_status.php').setData(e);new Dialog().setAsync(f).setCloseHandler(d).show();return false;}function _fbpage_show_change_status_feedback(a,b){if(!b||!a)return;if(b.reload){fbpage_reload_on_fan_status_changed(b.preserve_tab);}else fbpage_redraw_on_fan_status_changed(a,b.feedback);}function fbpage_reload_on_fan_status_changed(a){var b=URI.getRequestURI();if(a){var c=FutureSideNav.getInstance().selected.textKey;if(!b.getQueryData().sk&&c)b.addQueryData({sk:c});}window.location.href=b;}function fbpage_redraw_on_fan_status_changed(a,b){if(!b)return;if(Parent.byClass(a,'fbTimelineEscapeSectionItem'))a=Parent.byClass(a,'fan_status_inactive')||a;var c=DOM.create('span',{className:'fan_status_inactive'},b);a.parentNode.replaceChild(c,a);var d=function(){if(data.can_repeat_action)c.parentNode.replaceChild(a,c);};animation(c).duration(3000).checkpoint().to('backgroundColor','#FFFFFF').duration(1000).ondone(d).go();}function fbpage_toggle_like_on_fan_status_changed(a,b){var c=$('liked_pages_like_action_'+a),d=$('liked_pages_undo_action_'+a);CSS.conditionClass(c,'hidden_elem',b);CSS.conditionClass(d,'hidden_elem',!b);}
var PageLikeButton=window.PageLikeButton||(function(){function a(b,c,d,e,f){fbpage_set_fan_status(b,c,d,false,function(){Arbiter.inform(PageLikeButton.LIKED_SUCCESS,{profile_id:c});},e,{fan_origin:f});}return {LIKED:'liked',UNLIKED:'unliked',LIKED_SUCCESS:'liked_success',init:function(b,c,d,e,f,g){Arbiter.subscribe(PageLikeButton.LIKED,function(h,i){if(e===i.profile_id)b.swap();});Arbiter.subscribe(PageLikeButton.UNLIKED,function(h,i){if(e===i.profile_id){b.unswap();d.hideFlyout();}});if(g)Arbiter.subscribe(PageLikeButton.LIKED_SUCCESS,function(h,i){app_data=URI.getRequestURI().getQueryData().app_data;if(i.profile_id==e)new AsyncRequest().setURI('/ajax/pages/fetch_app_column.php').setData({profile_id:e,tab_key:g,app_data:app_data}).send();});Event.listen(c,'click',function(event){a(event.getTarget(),e,true,function(h){Arbiter.inform(PageLikeButton.UNLIKED,{profile_id:e});AsyncResponse.defaultErrorHandler(h);},f);Arbiter.inform(PageLikeButton.LIKED,{profile_id:e});Arbiter.inform(SubscribeButton.SUBSCRIBED,{profile_id:e});});},initUnlike:function(b,c,d){Event.listen(b,'click',function(event){a(event.getTarget(),c,false,function(e){Arbiter.inform(PageLikeButton.LIKED,{profile_id:c});AsyncResponse.defaultErrorHandler(e);},d);Arbiter.inform.bind(Arbiter,PageLikeButton.UNLIKED,{profile_id:c}).defer();Arbiter.inform.bind(Arbiter,SubscribeButton.UNSUBSCRIBED,{profile_id:c}).defer();});}};})();
var PlaceActionLink={start_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/start_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;},refer_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/refer_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;}};
var TimelineAggregatePost={init:function(a){Event.listen(a,'click',function(b){var c=b.getModifiers();if(b.isMiddleClick()||c.access||c.meta)return true;var d=Parent.byTag(b.getTarget(),'li');if(!CSS.hasClass(d,'wallPostMorePager'))new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},initPage:function(a){Event.listen(a,'click',function(b){var c=Parent.byClass(b.getTarget(),'uiCloseButton');if(c)return;var d=Parent.byTag(b.getTarget(),'li');new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},poke:function(a){ScrollableArea.poke(a);},setScrollHeight:function(a){var b=DOM.find(a,'.sArea');CSS.setStyle(b,'height',a.offsetHeight+'px');}};
var TimelinePageMostRecent={init:function(a,b){if(!CSS.shown(a)){CSS.show(a);TimelineAggregatePost.setScrollHeight($(b));TimelineCapsule.balanceCapsule(Parent.byClass($(a),'fbTimelineCapsule'));}}};
function PagesTimelineScrubber(a){this.parent.construct(this,a);}Class.extend(PagesTimelineScrubber,'TimelineMainScrubber');copy_properties(PagesTimelineScrubber,{PANEL_BODY_HEIGHT:430,ANIMATION_TIME_MS:250});PagesTimelineScrubber.show=function(a,b){if(ge('admin_panel')&&CSS.shown('admin_panel_body')){DOMScroll.scrollTo($('admin_panel'),true);return;}var c=$('admin_panel'),d=$('admin_panel_body');CSS.show(d);CSS.hide('adminPanelShowButton');CSS.show('adminPanelHideButton');if(b){d.style.height=PagesTimelineScrubber.PANEL_BODY_HEIGHT+'px';}else{d.style.height=0;animation(d).to('height',PagesTimelineScrubber.PANEL_BODY_HEIGHT).duration(PagesTimelineScrubber.ANIMATION_TIME_MS).go();DOMScroll.scrollTo(c,true);}new AsyncRequest('/ajax/pages/admin_panel/collapse.php').setData({pid:a,collapsed:false,in_tour:b}).setMethod('POST').send();};PagesTimelineScrubber.hide=function(a,b){if(ge('admin_panel')&&!CSS.shown('admin_panel_body'))return;var c=$('admin_panel_body');CSS.show('adminPanelShowButton');CSS.hide('adminPanelHideButton');if(b){c.style.height=0;CSS.hide(c);}else animation(c).to('height',0).hide().duration(PagesTimelineScrubber.ANIMATION_TIME_MS).go();new AsyncRequest('/ajax/pages/admin_panel/collapse.php').setData({pid:a,collapsed:true,in_tour:b}).setMethod('POST').send();};
__d("SwapButton",["event-extensions","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('CSS');function i(j,k,l){this._swapperButton=j;this._swappeeButton=k;Event.listen(j,'click',this.swap.bind(this));if(l)Event.listen(k,'click',this.unswap.bind(this));}g(i.prototype,{_swapperButton:null,_swappeeButton:null,swap:function(){h.hide(this._swapperButton);h.show(this._swappeeButton);},unswap:function(){h.show(this._swapperButton);h.hide(this._swappeeButton);}});e.exports=i;});
__d("HoverButton",["AsyncRequest","CSS","DOM","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('URI'),k=b('copyProperties');function l(m,n,o,p){this._button=m;this._flyout=n;this._flyoutAjaxify=p;this._flyoutContent=o;n.subscribe('show',this._onShow.bind(this));n.subscribe('hide',this._onHide.bind(this));}k(l.prototype,{_button:null,_flyout:null,_flyoutAjaxify:null,_flyoutContent:null,showFlyoutBriefly:function(){this.showFlyout();this._flyout.hideFlyoutDelayed(5000);},showFlyout:function(){this._flyout.showFlyout(this._button,true);this._flyout.inform('show',this._button);},hideFlyout:function(){this._flyout.hideFlyout(true);this._flyout.inform('hide',this._button);},_onShow:function(m,n){h.addClass(n,'uiHoverButtonSelected');h.addClass(n,'selected');if(this._flyoutAjaxify){h.addClass(this._flyoutContent,'async_saving');new g().setURI(new j(this._flyoutAjaxify)).setHandler(function(o){h.removeClass(this._flyoutContent,'async_saving');i.setContent(this._flyoutContent,o.payload);}.bind(this)).send();this._flyoutAjaxify=null;}},_onHide:function(m,n){h.removeClass(n,'uiHoverButtonSelected');h.removeClass(n,'selected');},destroy:function(){this.hideFlyout();this._flyout.destroy();}});e.exports=l;});
__d("HoverFlyout",["event-extensions","ArbiterMixin","Class","DataStore","LayerDestroyOnHide","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('DataStore'),j=b('LayerDestroyOnHide'),k=b('copyProperties');function l(m,n,o,p){if(m){this._showDelay=o;this._hideDelay=p;this.init(m);if(n)this.initNode(n);}}k(l.prototype,g,{init:function(m){this._flyout=m;this._showDelay=this._showDelay||0;this._hideDelay=this._hideDelay||100;this._showTimeout=null;this._hideTimeout=null;this._flyoutSubscriptions=[this._flyout.subscribe('mouseenter',this._onFlyoutMouseEnter.bind(this)),this._flyout.subscribe('mouseleave',this.hideFlyout.shield(this))];this._nodes=[];this._dataStoreUnique='HoverFlyout_'+Date.now()+'_listeners';this._flyout.disableBehavior(j);return this;},initNode:function(m){if(this._nodes.contains(m))return this;this._nodes.push(m);i.set(m,this._dataStoreUnique,[Event.listen(m,'mouseenter',this._onNodeMouseEnter.bind(this,m)),Event.listen(m,'mouseleave',this.hideFlyout.shield(this))]);return this;},deactivateNode:function(m){var n=i.get(m,this._dataStoreUnique);if(n)while(n.length)n.pop().remove();this._nodes.remove(m);},setShowDelay:function(m){this._showDelay=m;return this;},setHideDelay:function(m){this._hideDelay=m;return this;},showFlyout:function(m,n){this.setActiveNode(m);if(n){this._flyout.setContext(m).show();this.inform('show',m);}else this._showTimeout=this.showFlyout.bind(this,m,true).defer(this._showDelay);return this;},hideFlyout:function(m){clearTimeout(this._showTimeout);if(m){this._flyout.hide();this._activeNode&&this.inform('hide',this._activeNode);this._activeNode=null;}else this._hideTimeout=this.hideFlyout.bind(this,true).defer(this._hideDelay);},hideFlyoutDelayed:function(m){clearTimeout(this._showTimeout);clearTimeout(this._hideTimeout);this._hideTimeout=this.hideFlyout.bind(this,true).defer(m);},getActiveNode:function(){return this._activeNode;},setActiveNode:function(m){clearTimeout(this._hideTimeout);if(this._activeNode&&this._activeNode!==m)this.hideFlyout(true);this._activeNode=m;return this;},clearNodes:function(){for(var m=this._nodes.length;m>0;m--)this.deactivateNode(this._nodes[m-1]);},destroy:function(){while(this._flyoutSubscriptions.length)this._flyout.unsubscribe(this._flyoutSubscriptions.pop());this.clearNodes();},_onNodeMouseEnter:function(m){if(this._activeNode===m){clearTimeout(this._hideTimeout);}else this.showFlyout(m);},_onFlyoutMouseEnter:function(){clearTimeout(this._hideTimeout);}});e.exports=a.HoverFlyout||l;});
var FriendButtonIcon={init:function(a,b,c){var d=DOM.find(b,'.defaultIcon'),e=DOM.find(b,'.closeIcon'),f=DOM.find(b,'.acqIcon');Arbiter.subscribe('FriendListMembershipChange',function(g,h){if(h.uid==c){var i=h.lists.contains(FriendStatus.CLOSE_FRIENDS),j=h.lists.contains(FriendStatus.ACQUAINTANCES);if(i&&!j){Button.setIcon(a,e);}else if(j&&!i){Button.setIcon(a,f);}else Button.setIcon(a,d);}});}};
requireLazy(['Selector'],function(a){add_properties('__behaviors',{});if(__behaviors.TimelineCurationControl)return;__behaviors.TimelineCurationControl=true;a.subscribe('open',function(b,c){var d=c.selector,e=c.clone||d,f=Parent.byClass(e,'fbTimelineCurationControl');if(f){CSS.addClass(f,'editControlsMenuOpen');var g=a.subscribe('close',function(h,i){if(i.selector==d){a.unsubscribe(g);CSS.removeClass.curry(f,'editControlsMenuOpen').defer();}});}});});
__d("TimelineComposerUtilities",["event-extensions","Arbiter","Bootloader","CSS","DOM","Parent","TimelineCapsule","Vector"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('TimelineCapsule'),m=b('Vector'),n=86400*31,o=86400000,p={listenToSetEstimatedDate:function(q,r){return g.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,s){if(s.composer===q)s.date_picker.subscribe('initialized',function(t,u){p.setEstimatedDate(u,r());});});},listenToPublish:function(q,r){return g.subscribe('composer/publish',function(event,s){if(s.composer===q)h.loadModules(['TimelineStoryPublisher'],function(t){t.publish(s);r&&r();});});},listenToAnotherComposerOpen:function(q,r){return g.subscribe('composer/mutate',function(s,t){if(t!==q)r();});},listenToCancel:function(q,r){return Event.listen(q,'click',function(event){k.byClass(event.getTarget(),'cancelBtn')&&r();});},hidePlaceIfAttachmentsTooTall:function(q){var r=j.find(q,'ul.fbTimelineComposerAttachments'),s=m.getElementDimensions(r).y;if(s>50){var t=k.byTag(j.scry(r,'span.placeAttachment')[0],'li');t&&i.hide(t);}},setEstimatedDate:function(q,r){var s,t;if(r&&i.hasClass(r,'fbTimelineCapsule')){s=r.getAttribute('data-start');t=r.getAttribute('data-end');if(s&&t){var u=new Date(t*1000);if(t-s>2*n){q.setDate(u.getFullYear());}else q.setDate(u.getFullYear(),u.getMonth()+1);}return;}var v=k.byClass(r,'fbTimelineCapsule');if(v){s=v.getAttribute('data-start');t=v.getAttribute('data-end');var w=m.getElementPosition(r).y,x=[t,null],y=[s,null],z=l.getUnitsWithTime(v);for(var aa=0;aa<z.length;aa++){var ba=z[aa],ca=j.scry(ba.parentNode,'.spinePointer')[0];if(!ca)continue;var da=m.getElementPosition(ca).y;if(da<=w){if(!x[1]||da>x[1])x=[ba.getAttribute('data-time'),da];}else if(!y[1]||da<y[1])y=[ba.getAttribute('data-time'),da];}if(x[0]!==null&&y[0]!==null){var ea=Math.round((parseInt(x[0],10)+parseInt(y[0],10))/2)*1000;ea=Math.min(new Date()-o,ea);q.setDateWithTimestamp(ea);}}}};e.exports=p;});
__d("TimelineComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineCapsule","TimelineComposerUtilities","$"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineCapsule'),n=b('TimelineComposerUtilities'),o=b('$'),p;function q(v){if(v.isScheduledPost||v.isOGPost)return;if(!v.streamStory){window.location.reload();return;}if(v.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(z){z.publish(v);});return;}var w=k.byClass(p,'fbTimelineCapsule');if(!w)return;var x=k.byClass(p,'timelineUnitContainer').parentNode;if(x.nextSibling.getAttribute('data-spine'))x=x.nextSibling;var y=j.insertAfter(x,v.streamStory)[0];h.loadModules(['Animation'],function(z){z(y.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(z.ease.both).go();});m.setFirstUnit(w);m.balanceCapsule(w);}function r(){var v=k.byClass(p,'fbTimelineTwoColumn');return j.find(v,'.spinePointer');}function s(v){var w=t();i.show(w);var x=v.subscribe('hide',function(){i.hide(w);v.unsubscribe(x);});}function t(){var v=k.byClass(p,'fbTimelineTwoColumn'),w=j.scry(v,'div.composerVeil');if(w.length!==1)w=j.appendContent(v,j.create('div',{className:'composerVeil hidden_elem'}));return w[0];}var u={init:function(v){p=o(v);var w=g.subscribe('composer/publish',function(event,x){if(x.composer.root===p)q(x);});l.onLeave(function(){w.unsubscribe();});n.hidePlaceIfAttachmentsTooTall(p);},initComposerX:function(v){p=o(v);var w=g.subscribe('composer/publish',function(event,x){if(x.composer_id===v)q(x);});l.onLeave(function(){w.unsubscribe();});},showMLEFlyout:function(v){v.setContext(r()).show();s(v);}};e.exports=a.TimelineComposer||u;});
__d("RespondToRequestButton",["event-extensions","Arbiter","CSS","Menu"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('Menu'),j={init:function(k,l,m,n){Event.listen(l,'click',function(){h.addClass(l,'uiButtonConfirm');h.addClass(l,'selected');m.show();});m.subscribe('hide',function(){h.removeClass(l,'uiButtonConfirm');h.removeClass(l,'selected');});i.subscribe('select',function(o,p){if(!h.hasClass(p.menu,'requestResponseMenu'))return;if(p.item.firstChild.getAttribute('data-profileid')!=k)return;if(h.hasClass(p.item,'reject')){h.hide(l);h.show(n);}m.hide();g.inform('FriendRequest/delete');});}};e.exports=j;});
__d("legacy:RespondToRequestButton",["RespondToRequestButton"],function(a,b,c,d){a.RespondToRequestButton=b('RespondToRequestButton');},3);
__d("legacy:TooltipLink",["TooltipLink"],function(a,b,c,d){a.TooltipLink=b('TooltipLink');},3);
__d("TimelineStickyHeaderComposer",["event-extensions","Arbiter","Bootloader","Composer","CSS","DOMQuery","Parent","Run","TimelineComposerUtilities","TimelineContentLoader","TimelineStickyHeader","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Bootloader'),i=b('Composer'),j=b('CSS'),k=b('DOMQuery'),l=b('Parent'),m=b('Run'),n=b('TimelineComposerUtilities'),o=b('TimelineContentLoader'),p=b('TimelineStickyHeader'),q=b('Vector'),r=b('copyProperties');function s(t){this._container=l.byClass(t,'fbTimelineStickyHeaderComposer');var u='xhpc/construct/'+t.id;this._tokens=[];g.subscribe(u,function(v,w){this._composer=w;this._tokens=[n.listenToPublish(this._composer,this._close.bind(this)),n.listenToAnotherComposerOpen(this._composer,this._close.bind(this)),n.listenToSetEstimatedDate(this._composer,o.capsuleForCurrentSection),g.subscribe("PhotoSnowlift.OPEN",this._close.bind(this)),g.subscribe('TimelineMLE/mleFlyoutShown',function(x,y){if(i.getInstance(y.getContext())===this._composer){this._closeComposerAttachment();}else this._close();}.bind(this)),g.subscribe('TimelineMLE/mleFlyoutHidden',function(x,y){if(y.context&&!y.new_flyout&&i.getInstance(y.context)===this._composer)this._close();}.bind(this)),this._composer.subscribeToMutate(this._closeMLE.bind(this)),this._composer.subscribeToMutate(this._registerClickToDismiss.bind(this)),g.subscribe(p.ADJUST_WIDTH,this._toggleNarrowMode.bind(this))];}.bind(this));this._clickCancelToken=n.listenToCancel(t,this._close.bind(this));m.onLeave(function(){this._tokens.forEach(g.unsubscribe.bind(g));this._tokens=[];this._clickCancelToken.remove();this._clickCancelToken=null;this._clearClickDismissToken();}.bind(this));}r(s.prototype,{_toggleNarrowMode:function(event,t){h.loadModules(['Tooltip'],function(u){var v=q.getElementDimensions(t).x>400,w=k.scry(this._composer.root,'a.attachmentLink');j.conditionClass(this._composer.root.parentNode,'narrowStickyHeaderComposer',v);for(var x=0;x<w.length;x++){var y=w[x],z=k.getText(y);if(v){u.set(y,z);}else u.remove(y);}}.bind(this));return false;},_registerClickToDismiss:function(){var t=k.find(this._composer.root,'span.lifeEventAttachment');if(!j.hasClass(t,'uiComposerAttachmentSelected')){this._clearClickDismissToken();return;}this._clickDismissToken=Event.listen(document.body,'click',function(event){var u=event.getTarget();if(!l.byClass(u,'fbTimelineStickyHeaderComposer')){this._close();this._clearClickDismissToken();}}.bind(this));},_clearClickDismissToken:function(){if(this._clickDismissToken){this._clickDismissToken.remove();this._clickDismissToken=null;}},_close:function(){this._closeComposerAttachment();this._closeMLE();},_closeComposerAttachment:function(){this._clearClickDismissToken();this._composer.reset();j.removeClass(this._composer.root,'uiComposerOpen');},_closeMLE:function(){h.loadModules(['TimelineMLE'],function(t){var u=t.getFlyout();if(u&&i.getInstance(u.getContext())===this._composer)t.hideFlyout();}.bind(this));}});e.exports=s;});
function TimelineScrubber(a){this._root=a;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};var b=a.childNodes;this._currentNav=b[0];for(var c=0;c<b.length;c++){var d=b[c].getAttribute('data-key');this._navKeys[d]=b[c];var e=DOM.scry(b[c],'ul');this._subNavKeys[d]={};if(e.length){var f=e[0].childNodes;for(var g=0;g<f.length;g++)this._subNavKeys[d][f[g].getAttribute('data-key')]=f[g];}var h=b[c].getAttribute('data-rollup');if(h){this._rollups[h]=this._rollups[h]||[];this._rollups[h].push(b[c]);}}this._clickListener=Event.listen(this._root,'click',this._handleScrub.bind(this));CSS.show(this._root);var i=Vector2.getViewportDimensions().y-this.SCRUBBER_NO_ADS_VERTICAL_BUFFER,j=this.getHeight();if(j>i)this.fold(j-i);TimelineController.register(TimelineController.SCRUBBER,this);TimelineController.scrubberHasLoaded(this);}copy_properties(TimelineScrubber.prototype,{KEY_HEIGHT:23,SUBKEY_HEIGHT:16,OFFSET:38,SCRUBBER_NO_ADS_VERTICAL_BUFFER:125,reset:function(){this._root=null;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};},getRoot:function(){return this._root;},getNav:function(a){return this._navKeys[a];},getSubnav:function(a,b){return this._subNavKeys[a][b];},getHeight:function(){return this._root.offsetHeight;},getLabelForNav:function(a){var b=this.getNav(a);return b&&DOM.getText(DOM.scry(b,'a')[0]);},getLabelForSubnav:function(a,b){var c=this.getSubnav(a,b);return c&&DOM.getText(DOM.scry(c,'a')[0]);},fold:function(a){return this._adjustFolding(a,true);},unfold:function(a){return this._adjustFolding(a,false);},getOffset:function(){return this.OFFSET+(CSS.hasClass(document.body,'hasVoiceBar')?26:0)+(CSS.hasClass('rightColContent','pagesTimelineRightColumn')?34:0);},updateSection:function(a,b){var c=this._navKeys[a].getAttribute('data-rollup');if(this._currentRollup&&this._currentRollup!=c){CSS.removeClass(this._currentRollup,'selected');CSS.removeClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');delete this._currentRollup;}if(c&&this._rolledup[c]){var d=this._rolledup[c];if(d.getAttribute('data-rollup')){this._currentRollup=d;CSS.addClass(this._currentRollup,'selected');CSS.addClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');}}this._currentNav&&CSS.removeClass(this._currentNav,'selected');this._currentSubNav&&CSS.removeClass(this._currentSubNav,'selected');this._currentNav=null;this._currentSubNav=null;if(this._navKeys[a]){this._currentNav=this._navKeys[a];CSS.addClass(this._currentNav,'selected');if(this.decadesAreSelectable&&this._navKeys[b]){this._currentSubNav=this._navKeys[b];CSS.addClass(this._currentSubNav,'selected');}else if(b&&this._subNavKeys[a][b]){this._currentSubNav=this._subNavKeys[a][b];CSS.addClass(this._currentSubNav,'selected');}}},_getRollupSize:function(a){var b=this._currentNav,c=b&&b.getAttribute('data-rollup'),d=this.KEY_HEIGHT*(this._rollups[a].length-1);if(a==c){d+=this.SUBKEY_HEIGHT*DOM.scry(b,'li').length;d-=this.SUBKEY_HEIGHT*(this._rollups[a].length-1);}return d;},_adjustFolding:function(a,b){var c=a,d=keys(this._rollups);while(a>0&&d.length){var e=d[b?'pop':'shift']();if(!b==!this._rolledup[e])continue;var f=this._getRollupSize(e);if(f<=0)continue;if(!b&&f>a)break;this[b?'_collapseRollup':'_expandRollup'](e);a-=f;}return c-a;},_collapseRollup:function(a){var b=this._rollups[a];if(!b||b.length<2||this._rolledup[a])return;var c=b[0].previousSibling,d=b[0],e=DOM.create('a',{href:d.firstChild.href,rel:'ignore'},[a]),f=DOM.create('ul',{className:'clearfix'});for(var g=0;g<b.length;g++)f.appendChild(b[g]);var h=DOM.create('li',null,[e,f]);if(this.decadesAreSelectable){var i=b[b.length-1],j=d.getAttribute('data-key')+i.getAttribute('data-key');h.setAttribute('data-start',i.getAttribute('data-start'));h.setAttribute('data-end',d.getAttribute('data-end'));h.setAttribute('data-key',j);this._navKeys[j]=h;}else h.setAttribute('data-key',d.getAttribute('data-key'));h.setAttribute('data-rollup',a);if(c){DOM.insertAfter(c,h);}else DOM.prependContent(this._root,h);this._rolledup[a]=h;this._checkSelection();},_expandRollup:function(a){if(!this._rolledup[a])return;var b=this._rolledup[a],c=DOM.scry(b,'ul')[0],d=document.createDocumentFragment();while(c.childNodes.length)d.appendChild(c.firstChild);DOM.replace(b,d);this._rolledup[a]=false;this._checkSelection();},_checkSelection:function(){if(this._currentNav){var a=this._currentSubNav&&this._currentSubNav.getAttribute('data-key');this.updateSection(this._currentNav.getAttribute('data-key'),a);}},_handleScrub:function(event){var a=event.getModifiers();if(event.isMiddleClick()||a.access||a.meta)return true;var b=Parent.byTag(event.getTarget(),'a'),c=b&&Parent.byAttribute(b,'data-key');if(c){TimelineController.scrubberWasClicked(c.getAttribute('data-key'));TimelineController.navigateToSection(c.getAttribute('data-key'));return event.prevent();}}});
function TimelineMainScrubber(a){this.parent.construct(this,a);this._subscribe=Arbiter.subscribe(TimelineController.SECTION_LOADED,function(b,c){var d=this._navKeys[c.key],e=d&&DOM.scry(d,'ul')[0];if(e){CSS.addClass(e,'loaded');TimelineController.scrubberHasChangedState();if(c.hideSubSections)CSS.hide(e);}}.bind(this));}Class.extend(TimelineMainScrubber,'TimelineScrubber');copy_properties(TimelineMainScrubber.prototype,{reset:function(){this.parent.reset();this._subscribe&&this._subscribe.unsubscribe();}});
__d("StickyController",["event-extensions","CSS","Style","Vector","copyProperties","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('Style'),i=b('Vector'),j=b('copyProperties'),k=b('throttle');function l(m,n,o,p){this._element=m;this._marginTop=n;this._onchange=o;this._proxy=p||m.parentNode;}j(l.prototype,{handleScroll:function(){var m=i.getElementPosition(this._proxy,'viewport').y<=this._marginTop;if(this.isFixed()!==m){h.set(this._element,'top',m?this._marginTop+'px':'');g.conditionClass(this._element,'fixed_elem',m);this._onchange&&this._onchange(m);}},start:function(){if(this._event)return;this._event=Event.listen(window,'scroll',k(this.handleScroll,100,this));this.handleScroll.bind(this).defer();},stop:function(){this._event&&this._event.remove();this._event=null;},isFixed:function(){return g.hasClass(this._element,'fixed_elem');}});e.exports=l;});
__d("requestAnimationFrame",[],function(a,b,c,d,e,f){var g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(h){window.setTimeout(h,16);};e.exports=g;});
__d("BrokenProfilePicLogger",["Run","DOM","JSLogger"],function(a,b,c,d,e,f){var g=b("Run"),h=b("DOM"),i=b("JSLogger"),j=i.create("entities_profile_pics"),k={checkAndLog:function(l){g.onAfterLoad(function(){var m=h.find(l,"img");if(!m.complete||(typeof m.naturalWidth!="undefined"&&m.naturalWidth===0))j.log('broken_link',{src:m.getAttribute('src')});});}};e.exports=k;});
__d("TimelineConstants",[],function(a,b,c,d,e,f){var g={DS_HEIGHT:'timeline-unit-height',DS_LOADED:'timeline-capsule-loaded',DS_SIDEORG:'timeline-unit-sideorg',DS_TAILBALANCE:'timeline-capsule-tailbalance',DS_COLUMN_HEIGHT_DIFFERENTIAL:'timeline-column-diff-height',FIXED_SIDE_LEFT:'left',FIXED_SIDE_RIGHT:'right',FIXED_SIDE_BOTH:'both',SCROLL_TO_OFFSET:30,SUBSECTION_SCROLL_TO_OFFSET:90};e.exports=g;});
__d("TimelineURI",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={TIMELINE_KEY:'timeline',WALL_KEY:'wall',parseURI:function(i){i=g(i);var j=i.getQueryData(),k=i.getPath(),l=k.split('/').slice(1);if(l[0]=='people'||l[0]=='pages')l=l.slice(2);var m=j.sk||l[1]||h.TIMELINE_KEY;if(m==h.WALL_KEY)m=h.TIMELINE_KEY;var n=null,o=null;if(m==h.TIMELINE_KEY){o=parseInt(l[2],10)||null;n=parseInt(l[3],10)||null;}return {path:k,id:j.id||l[0],key:m,viewas:j.viewas?j.viewas:0,filter:j.filter?j.filter:null,year:o,month:n,friendship:!!j.and};}};e.exports=h;});
__d("TimelineController",["event-extensions","Arbiter","CSS","DataStore","DOM","Run","ScrollingPager","Style","TimelineConstants","TimelineURI","Vector","ViewportBounds","$","ge","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('Run'),l=b('ScrollingPager'),m=b('Style'),n=b('TimelineConstants'),o=b('TimelineURI'),p=b('Vector'),q=b('ViewportBounds'),r=b('$'),s=b('ge'),t=b('throttle'),u=484,v=48,w=740,x=1285,y=null,z=false,aa,ba,ca,da={},ea={},fa=[],ga=null,ha=0,ia=false,ja=false,ka=false,la={allactivity:true,approve:true,games:true,map:true,music:true,video:true};la[o.TIMELINE_KEY]=true;var ma=[],na=false;function oa(){ga&&ga.remove();ga=null;}function pa(ya,za,ab){ab=ab||[];if(da[ya])return da[ya][za].apply(da[ya],ab);ea[ya]=ea[ya]||{};ea[ya][za]=ab;return false;}function qa(){if(!(ia||ka||ja)){oa();return;}var ya=p.getScrollPosition();ia=ia&&sa(r('rightCol'),ya,'paddingTop',true);ja=ja&&sa(r('pagelet_above_header_timeline'),ya,'top');ka=ka&&sa(r('blueBar'),ya,'paddingTop');}function ra(){var ya=p.getScrollPosition(),za=ha===0||ya.y>=ha;pa(xa.STICKY_HEADER,'toggle',[za]);pa(xa.CONTENT,'checkCurrentSectionChange');}function sa(ya,za,ab,bb){if(!ya){oa();return;}if(za.y<=0){ta(ya,ab);return false;}else{var cb=bb&&xa.getCurrentScrubber();if((cb&&h.hasClass(cb.getRoot(),'fixed_elem'))||m.isFixed(s('pagelet_timeline_friends'))){ta(ya,ab);return false;}else{var db=parseInt(ya.style[ab],10)||0;if(za.y<db){h.addClass(ya,'timeline_fixed');ya.style[ab]=za.y+'px';}else h.removeClass(ya,'timeline_fixed');}}return true;}function ta(ya,za){ya.style[za]='0px';h.removeClass(ya,'timeline_fixed');}function ua(){pa(xa.ADS,'adjustAdsType',[xa.shouldShowWideAds()]);pa(xa.ADS,'adjustAdsToFit');pa(xa.CONTENT,'adjustContentPadding');pa(xa.STICKY_HEADER_NAV,'adjustMenuHeights');}function va(ya,za){if(ya=='sidebar/initialized')na=true;pa(xa.ADS,'adjustAdsType',[xa.shouldShowWideAds()]);}function wa(){while(fa.length)fa.pop().remove();for(var ya in da)da[ya].reset&&da[ya].reset();oa();ca.unsubscribe();ca=null;y=null;aa=null;da={};ea={};ha=0;ja=false;if(ia){r('rightCol').style.paddingTop='';h.removeClass(r('rightCol'),'timeline_fixed');}ia=false;if(ka){r('blueBar').style.paddingTop='';h.removeClass(r('blueBar'),'timeline_fixed');}ka=false;ma=[];na=false;z=false;i.purge(n.DS_HEIGHT);i.purge(n.DS_LOADED);i.purge(n.DS_SIDEORG);i.purge(n.DS_TAILBALANCE);i.purge(n.DS_COLUMN_HEIGHT_DIFFERENTIAL);}var xa={NAV:'nav',STICKY_HEADER:'sticky_header',STICKY_HEADER_NAV:'sticky_header_nav',SCRUBBER:'scrubber',CONTENT:'content',ADS:'ads',COVER:'cover',LOGGING:'logging',SECTION_LOADING:'TimelineController/sectionLoading',SECTION_LOADED:'TimelineController/sectionLoaded',SECTION_FULLY_LOADED:'TimelineController/sectionFullyLoaded',SECTION_REGISTERED:'TimelineController/sectionRegistered',SCRUBBER_DEFAULT_OFFSET:38,init:function(ya,za,ab){if(z)return;if(za==o.WALL_KEY)za=o.TIMELINE_KEY;z=true;aa=ya;ba=ab.has_fixed_ads;pa(xa.CONTENT,'adjustContentPadding');fa.push(Event.listen(window,'scroll',t(ra,100)),Event.listen(window,'resize',t(ua,100)));ca=g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide'],va);k.onLeave(wa);xa.registerCurrentKey(za);},setAdsTracking:function(ya){pa(xa.ADS,'start',[ya]);},coverHasExpanded:function(ya){r('rightCol').style.paddingTop=ya+'px';ia=true;var za=r('pagelet_above_header_timeline');if(za.firstChild){r('above_header_timeline_placeholder').style.height=za.offsetHeight+'px';za.style.top=ya+'px';ja=true;}var ab=document.documentElement;ka=ab.clientHeight<400||ab.clientWidth<ab.scrollWidth;if(ka)r('blueBar').style.paddingTop=ya+'px';ga=Event.listen(window,'scroll',qa);},pageHasScrubber:function(ya){return !ya||ya.match(/^(og_)?app_/)||(ya in la);},fixedAds:function(){return ba;},registerCurrentKey:function(ya){y=ya;var za=p.getViewportDimensions().y<w;pa(xa.ADS,'setShortMode',[za,ya]);pa(xa.ADS,'updateCurrentKey',[ya]);ha=ya==o.TIMELINE_KEY?u-v:0;},getCurrentKey:function(){return y;},getSectionKeys:function(){return ma;},getCurrentScrubber:function(){return da[xa.SCRUBBER];},getCurrentStickyHeaderNav:function(){return da[xa.STICKY_HEADER_NAV];},getSection:function(ya){return pa(xa.CONTENT,'getSection',[ya]);},scrubberHasLoaded:function(ya){pa(xa.STICKY_HEADER_NAV,'addTimePeriods',[ma]);pa(xa.ADS,'registerScrubber',[ya]);},registerSectionKey:function(ya,za){if(da[xa.STICKY_HEADER_NAV]){pa(xa.STICKY_HEADER_NAV,'addTimePeriod',[ya]);}else ma[za]=ya;},scrubberHasChangedState:function(){pa(xa.ADS,'adjustAdsToFit');},scrubberWasClicked:function(ya){pa(xa.LOGGING,'logScrubberClick',[ya]);},sectionHasChanged:function(ya,za){pa(xa.STICKY_HEADER_NAV,'updateSection',[ya,za]);pa(xa.SCRUBBER,'updateSection',[ya,za]);pa(xa.ADS,'loadAdsIfEnoughTimePassed');pa(xa.LOGGING,'logSectionChange',[ya,za]);},navigateToSection:function(ya){pa(xa.CONTENT,'navigateToSection',[ya]);},shouldShowWideAds:function(){if(!na)return false;var ya=x+q.getRight();return p.getViewportDimensions().x>=ya;},sidebarInitialized:function(){return na;},adjustStickyHeaderWidth:function(){pa(xa.STICKY_HEADER,'adjustWidth');},register:function(ya,za){da[ya]=za;if(ea[ya]){for(var ab in ea[ya])pa(ya,ab,ea[ya][ab]);delete ea[ya];}},adjustScrollingPagerBuffer:function(ya,za){var ab=i.get(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,za);if(!ab)return;var bb=l.getInstance(ya);bb&&bb.setBuffer(bb.getBuffer()+Math.abs(ab));},runOnceWhenSectionFullyLoaded:function(ya,za,ab){if(pa(xa.CONTENT,'getSection',[za])){var bb=false;j.scry(da[xa.CONTENT].getSection(za).node,'ol.fbTimelineCapsule').forEach(function(db){if(!bb&&i.get(n.DS_LOADED,db.id)===ab){ya();bb=true;}});if(bb)return;}var cb=g.subscribe(xa.SECTION_FULLY_LOADED,function(db,eb){if(eb.scrubberKey===za&&eb.pageIndex===ab){ya();cb.unsubscribe();}});}};e.exports=xa;});
__d("TimelinePerfConfig",[],function(a,b,c,d,e,f){var g=null,h=function(){if(g===null)return false;return true;},i={init:function(j){g=j;},getDisablePageletThrottle:function(){return h()&&(g.disablePageletThrottle||g.disableAllThrottle);},getDisableAllThrottle:function(){return h()&&g.disableAllThrottle;},getDisableSpineHeight:function(){return h()&&g.disableSpineHeight;}};e.exports=i;});
__d("TimelineSmartInsert",["CSS","DOM","Run","UserAgent","Vector"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Run'),j=b('UserAgent'),k=b('Vector'),l=false,m=false;function n(){if(m)return;i.onLeave(o);m=true;}function o(){l=false;m=false;}var p={BUFFER:100,run:function(q,r){n();if(!l||j.ie()<=8){r();return;}var s=q.offsetHeight;r();var t=q.offsetHeight;if(t-s!==0&&k.getElementPosition(q).y+s<k.getScrollPosition().y+p.BUFFER)window.scrollBy(0,t-s);},enable:function(){l=true;}};e.exports=p;});
__d("TimelineThrottler",["event-extensions","Arbiter","TimelinePerfConfig","copyProperties","debounce","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('TimelinePerfConfig'),i=b('copyProperties'),j=b('debounce'),k=b('throttle');function l(m){this.id=m;this.idle=true;this.keys={};this.queue=[];this.config={};this.configure();l.instances[m]=this;}l.getInstance=function(m){return l.instances[m]||new l(m);};l.instances={};l.config={};l.REQUEUE='requeue';g.subscribe("Timeline/throttle",function(m,n){l.config=n;for(var o in l.instances)l.instances[o].configure();});i(l.prototype,{configure:function(){if(this._handle)this._handle.remove();var m=j(function(){this.idle=true;this._process();},l.config.scrollDelay||400,this),n=k(function(){this.idle=false;m();},l.config.scrollThrottle||100,this);this._handle=Event.listen(window,'scroll',n);i(this.config,l.config[this.id]);},cancel:function(){this.idle=true;this.keys={};this.queue=[];this.config={};this._handle&&this._handle.remove();},_limit:function(m,n,o){if(h.getDisableAllThrottle()){m();return;}var p=m;if(n){if(this.keys[n])if(o){this.queue.splice(this.queue.indexOf(this.keys[n]),1);}else return;this.keys[n]=m;p=function(){delete this.keys[n];m();}.bind(this);}this.queue.push(p);this._process();},throttle:function(m,n){this._limit(m,n,false);},debounce:function(m,n){this._limit(m,n,true);},_process:function(){if(this.idle&&this.queue.length){var m=this.queue.shift(),n=m();if(n===l.REQUEUE)this.queue.push(m);setTimeout(this._process.bind(this),this.config.delay||0);}}});e.exports=l;});
__d("TimelineContentLoader",["event-extensions","Arbiter","CSS","DOM","DOMScroll","OnVisible","ScrollingPager","TimelineConstants","TimelineController","TimelinePerfConfig","TimelineSmartInsert","TimelineThrottler","TimelineURI","UIPagelet","UserAgent","Vector","$","copyProperties","createArrayFrom","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DOMScroll'),k=b('OnVisible'),l=b('ScrollingPager'),m=b('TimelineConstants'),n=b('TimelineController'),o=b('TimelinePerfConfig'),p=b('TimelineSmartInsert'),q=b('TimelineThrottler'),r=b('TimelineURI'),s=b('UIPagelet'),t=b('UserAgent'),u=b('Vector'),v=b('$'),w=b('copyProperties'),x=b('createArrayFrom'),y=b('debounce'),z=b('ge'),aa=b('startsWith'),ba=b('tx'),ca=b('userAction'),da=false,ea=false,fa,ga={},ha=null,ia={},ja=[],ka=[],la={},ma={},na={},oa=null,pa=null,qa=null,ra=false,sa=null;function ta(eb,fb,gb,hb,ib){this.node=eb;this.loaded=hb;this.canScrollLoad=true;this.canUnload=fb!=db.RECENT;this.scrubberKey=fb;this.historicUnitCount=ib;this._pageletLoadData=gb;this._expandPageletLoadData={};}w(ta.prototype,{load:function(eb){if(this.loaded)return;var fb=this._pageletLoadData;g.inform(n.SECTION_LOADING,{data:fb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var gb='ProfileTimelineSectionPagelet';if(this.scrubberKey==db.WAY_BACK)gb='ProfileTimelineRemainingYearsPagelet';fb.time_cutoff=db.getTimeCutoff();fb.highlight_unit_data=eb;fb.parent_key=this.parentKey;fb.force_no_friend_activity=ra;h.addClass(this.node,'fbTimelineSectionLoading');var hb=null;if(!eb&&!o.getDisablePageletThrottle())hb=xa.curry(this.node);if(this.canUnload&&ea){var ib=this.node.firstChild.cloneNode(true);h.hide(ib);i.insertAfter(this.node,ib);}else this.canScrollLoad=false;na[this.scrubberKey]=s.loadFromEndpoint(gb,this.node.id,fb,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:hb});cb(this.scrubberKey);},preload:function(){h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var eb=i.find(this.node,'span.sectionLabel');if(eb.getAttribute('data-original-label')){i.setContent(eb,eb.getAttribute('data-original-label'));eb.removeAttribute('data-original-label');}},unload:function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;na[this.scrubberKey]&&na[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();},activateScrollLoad:function(){this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');ma[this.scrubberKey]&&ma[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');ma[this.scrubberKey]&&ma[this.scrubberKey].remove();}},setExpandLoadData:function(eb){this._expandPageletLoadData=eb;return this;},expandSubSections:function(){if(this.subSections.length)db.navigateToSection(this.subSections[0].scrubberKey);},expand:function(eb){if(!this.loaded)return;qa.add_event('expand_'+this.scrubberKey);var fb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(fb.firstChild,'async_saving');eb&&h.addClass(eb,'async_saving');this._expandPageletLoadData.time_cutoff=db.getTimeCutoff();db.navigateToSection(this.scrubberKey);i.scry(this.node,'ol.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;na[this.scrubberKey]&&na[this.scrubberKey].cancel();na[this.scrubberKey]=s.loadFromEndpoint('ProfileTimelineSectionPagelet',fb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});},isPermalinkPeriod:function(){return this._pageletLoadData.is_permalink_period;}});function ua(){if(da)return;n.register(n.CONTENT,db);qa=ca('scrubber').set_namespace('timeline').set_ua_id('scrubber');da=true;if(t.ie()<=7)ea=true;}var va=y(function(eb,fb,gb){var hb=db.getSection(eb).historicUnitCount;fb-=hb;gb-=1;if(hb==-1||gb<=0||fb<0)return;var ib=db.getNextSectionKey(eb);if(ib){db.getSection(ib).load();va(ib,fb,gb);}},500),wa={};function xa(eb,fb){oa=q.getInstance('displayPagelet');oa.throttle(function(){var gb=u.getViewportDimensions().y,hb=u.getScrollPosition().y,ib=hb+gb,jb=hb+gb*(oa.config.fociRatio||.5),kb=u.getElementPosition(eb).y;if(kb>jb)if(kb<ib){wa[eb.id]=(wa[eb.id]||0)+1;if(wa[eb.id]<(oa.config.fociPenalty||3))return q.REQUEUE;}else{delete wa[eb.id];return q.REQUEUE;}delete wa[eb.id];fb();});}function ya(eb,fb,gb){var hb=db.getNextSectionKey(fb);if(hb)ma[hb]=new k(eb,za.curry(hb,eb),false,gb||1000);}function za(eb,fb){if(ga[eb].canScrollLoad){qa.add_event("scroll_load_"+eb);if(ea){db.getSection(eb).preload();}else{db.getSection(eb).load();if(sa)va(eb,sa.required_units,sa.max_parallelism);}fb&&i.remove(fb);}}function ab(){var eb,fb,gb=false;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;var jb=db.getSection(ib);if(jb.canScrollLoad||jb.loaded){if(!jb.loaded){h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}if(eb&&fb){bb(eb,fb);if(gb)eb.deactivateScrollLoad();gb=true;}eb=null;fb=null;continue;}else if(eb){fb=jb;jb.deactivateScrollLoad();}else{eb=jb;if(gb)jb.activateScrollLoad();}h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}}function bb(eb,fb){h.removeClass(fb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(fb.node,'fbTimelineTimePeriodSuppressed');var gb=i.find(eb.node,'span.sectionLabel'),hb=i.find(fb.node,'span.sectionLabel');if(!hb.getAttribute('data-original-label'))hb.setAttribute('data-original-label',i.getText(hb));if(gb.getAttribute('data-month')&&hb.getAttribute('data-month')&&gb.getAttribute('data-year')==hb.getAttribute('data-year')){i.setContent(hb,ba._("Mostrar {month1} a {month2} de {year}",{month1:hb.getAttribute('data-month'),month2:gb.getAttribute('data-month'),year:gb.getAttribute('data-year')}));}else if(gb.getAttribute('data-year')!==hb.getAttribute('data-year')){i.setContent(hb,ba._("Mostrar  {year1} a {year2}",{year1:hb.getAttribute('data-year'),year2:gb.getAttribute('data-year')}));}else i.setContent(hb,ba._("Mostrar {year}",{year:hb.getAttribute('data-year')}));}function cb(eb){if(ea)for(var fb=0;fb<ja.length-1;fb++){var gb=ja[fb];if(!gb)continue;if(gb!=eb){var hb=ga[gb];if(hb.loaded&&hb.canUnload)hb.unload();}}ab();}var db={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(eb,fb,gb,hb,ib,jb,kb){ua();if(ka.contains(fb))return;var lb=new ta(eb,fb,gb,hb,kb);if(!ib){ja[jb]=fb;ia[fb]=true;}else{lb.parentKey=ib;ga[ib].subSections=ga[ib].subSections||[];ga[ib].subSections[jb]=lb;}ga[fb]=lb;db.checkCurrentSectionChange();g.inform(n.SECTION_REGISTERED,{scrubberKey:fb});n.registerSectionKey(fb,jb);},reset:function(){for(var eb in ma)ma[eb].remove();for(var fb in na)na[fb].cancel();fa&&fa.unsubscribe();fa=null;oa&&oa.cancel();oa=null;ga={};ha=null;ia={};ja=[];ka=[];la={};ma={};na={};pa=null;qa=null;ra=false;da=false;},checkCurrentSectionChange:function(){var eb=db.getCurrentSection(),fb=ha&&ha.scrubberKey;if(eb&&eb.scrubberKey!==fb&&!eb.isPermalinkPeriod()){ha=eb;var gb=eb.scrubberKey,hb=eb.parentKey;if(!hb){hb=gb;gb=null;}n.sectionHasChanged(hb,gb);}},setTimeCutoff:function(eb){pa=eb;},getTimeCutoff:function(){return pa;},setParallelLoadConfig:function(eb){sa=eb;},getCurrentSection:function(){var eb={};for(var fb in ga){var gb=ga[fb];if(!gb.loaded||la[gb.scrubberKey])continue;var hb=u.getElementPosition(gb.node,'viewport').y;if(gb.scrubberKey=='recent')hb--;if(hb<db.CURRENT_SECTION_OFFSET)eb[hb]=gb;}var ib=Math.max.apply(null,Object.keys(eb)),jb=ib==-Infinity;if(!jb){return eb[ib];}else if(ja[0])return ga[ja[0]];return null;},capsuleForCurrentSection:function(){var eb=db.getCurrentSection();return eb&&i.scry(eb.node,'ol.fbTimelineCapsule')[0];},enableScrollLoad:function(eb,fb,gb,hb){eb=v(eb);var ib=i.scry(eb.parentNode,'ol.fbTimelineCapsule')[0];if(!ib)return;if(gb===null){ya(eb,fb,hb);}else n.runOnceWhenSectionFullyLoaded(ya.curry(eb,fb,hb),fb,gb);},enableScrollLoadOnClick:function(eb,fb,gb){eb=v(eb);Event.listen(eb,'click',function(hb){hb.preventDefault();db.enableScrollLoad(eb,fb,null,gb);});},expandSectionOnClick:function(eb,fb){Event.listen(eb,'click',function(gb){gb.preventDefault();db.getSection(fb).expand();});},expandSubSectionsOnClick:function(eb,fb){Event.listen(eb,'click',function(gb){gb.preventDefault();db.getSection(fb).expandSubSections();});},getSection:function(eb){return ga[eb];},getNextSectionKey:function(eb){for(var fb=0;fb<ja.length-1;fb++)if(ja[fb]==eb){while(fb<ja.length-1&&!ja[fb+1])fb++;return ja[fb+1];}var gb=db.getSection(eb);if(!gb||!gb.parentKey)return;var hb=db.getSection(gb.parentKey);if(!hb)return;for(var ib=0;ib<hb.subSections.length-1;ib++)if(hb.subSections[ib].scrubberKey==eb)return hb.subSections[ib+1].scrubberKey;},hideSection:function(eb){var fb=db.getSection(eb);fb&&h.hide(fb.node);var gb=n.getCurrentScrubber();if(gb){var hb=n.getCurrentScrubber().getNav(eb);hb&&h.hide(hb);}var ib=n.getCurrentStickyHeaderNav();ib&&ib.removeTimePeriod(eb);la[eb]=true;},loadSectionOnClick:function(eb,fb){Event.listen(eb,'click',function(gb){gb.preventDefault();db.getSection(fb).load();});},removeSection:function(eb){for(var fb in ja)if(ja[fb]==eb){ja[fb]=null;break;}delete ga[eb];delete ia[eb];if(eb in ma){ma[eb].remove();delete ma[eb];}var gb=n.getCurrentStickyHeaderNav();gb&&gb.removeTimePeriod(eb);ka.push(eb);},removeSectionParent:function(eb){i.remove(v(eb).parentNode);},navigateToSection:function(eb,fb,gb){qa.add_event("nav_"+eb);fb=!!fb;var hb=eb,ib=db.getSection(eb);if(!ib)return;if(!ib.loaded)p.enable();if(!ia[eb]){ib.node.style.minHeight=u.getViewportDimensions().y+'px';var jb=g.subscribe(n.SECTION_FULLY_LOADED,function(rb,sb){if(sb.scrubberKey===eb){ib.node.style.minHeight='';jb.unsubscribe();}});hb=ib.parentKey;var kb=db.getSection(hb).node;if(!h.hasClass(kb,'fbTimelineSectionExpanded')){j.scrollTo(kb,0);h.addClass(kb,'fbTimelineSectionExpanded');i.scry(kb,'ol.fbTimelineCapsule').forEach(i.remove);i.scry(kb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(kb,'div.fbTimelineContentHeader').forEach(i.remove);}var lb=db.getNextSectionKey(hb);if(lb&&ma[lb])ma[lb].setBuffer(0);}for(var mb=0;mb<ja.length;mb++){var nb=ja[mb];if(!nb)continue;if(nb==hb)break;db.getSection(nb).deactivateScrollLoad();i.scry(v('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(rb){var sb=l.getInstance(rb.id);sb&&sb.removeOnVisible();});}db.adjustContentPadding();ib.load(gb);ab();var ob=u.getScrollPosition().x,pb=u.getElementPosition(ib.node).y;if(!fb){var qb=ia[eb]?m.SCROLL_TO_OFFSET:m.SUBSECTION_SCROLL_TO_OFFSET;j.scrollTo(new u(ob,pb-qb,'document'),true,false,false,function(){var rb=u.getElementPosition(ib.node).y;j.scrollTo(new u(ob,rb-qb,'document'),false);var sb=i.scry(ib.node,'h3.uiHeaderTitle')[0];sb&&sb.focus();});}},adjustContentPadding:function(){var eb=z('timeline_tab_content');if(!eb)return;var fb=n.getCurrentKey()||r.TIMELINE_KEY;if(fb!==r.TIMELINE_KEY)return;var gb=db.getSection(db.WAY_BACK);eb.style.paddingBottom=gb&&gb.loaded?null:u.getViewportDimensions().y-db.CURRENT_SECTION_OFFSET-db.HEADER_SCROLL_CUTOFF-db.FOOTER_HEIGHT+'px';},adjustContentPaddingAfterLoad:function(eb,fb){n.runOnceWhenSectionFullyLoaded(db.adjustContentPadding,eb,fb);},appendContentAfterLoad:function(eb,fb,gb){n.runOnceWhenSectionFullyLoaded(i.appendContent.curry(v(eb),fb),gb,'0');},suppressSectionsAbove:function(eb){var fb,gb;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;fb=db.getSection(ib).node;gb=null;if(x(eb.parentNode.children).indexOf(eb)<=x(fb.parentNode.children).indexOf(fb)){gb=ib;break;}db.getSection(ib).deactivateScrollLoad();}if(gb)db.navigateToSection(gb,true);},forceNoFriendActivity:function(){ra=true;},removeDupes:function(eb){var fb=z(eb);if(!fb)return;var gb=i.scry(fb,'li.fbTimelineUnit'),hb={};for(var ib=0;ib<gb.length;ib++){var jb=gb[ib];if(jb.id&&aa(jb.id,'tl_unit_')){var kb=jb.id.substring(8,jb.id.length),lb=(jb.getAttribute('data-unit')=='ExperienceSummaryUnit'?jb.getAttribute('data-time'):1);if(hb.hasOwnProperty(kb)&&hb[kb]==lb){i.remove(jb);}else hb[kb]=lb;}}},removeLoadingState:function(eb){z(eb)&&h.removeClass(v(eb),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(eb,fb){var gb=db.getSection(eb);gb&&gb.setExpandLoadData(fb);}};e.exports=db;});
__d("TimelineCapsule",["$","Arbiter","createArrayFrom","CSS","DataStore","DOM","DOMQuery","DOMScroll","ge","Hovercard","Parent","TimelineConstants","TimelineContentLoader","TimelineController","TimelineSmartInsert","TimelineThrottler","UserAgent","Vector","isEmpty","requestAnimationFrame"],function(a,b,c,d,e,f){var g=b('$'),h=b('Arbiter'),i=b('createArrayFrom'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('DOMQuery'),n=b('DOMScroll'),o=b('ge'),p=b('Hovercard'),q=b('Parent'),r=b('TimelineConstants'),s=b('TimelineContentLoader'),t=b('TimelineController'),u=b('TimelineSmartInsert'),v=b('TimelineThrottler'),w=b('UserAgent'),x=b('Vector'),y=b('isEmpty'),z=b('requestAnimationFrame'),aa=(function(){var ba=45,ca=15,da='use',ea='update',fa={},ga={},ha={},ia={};function ja(bb){return j.hasClass(bb,'fbTimelineBalancer');}function ka(bb){return bb.getAttribute('data-spine');}function la(bb){return j.hasClass(bb,'placeholderUnit');}function ma(bb){return bb.getAttribute('data-fixed');}function na(bb,cb){if(cb)return (k.get(r.DS_SIDEORG,bb.id)||bb.getAttribute('data-side'));return bb.getAttribute('data-side');}var oa=function(bb,cb){if(w.ie()<=6){oa=function(db,eb){k.set(r.DS_SIDEORG,db.id,na(db,true));db.setAttribute('data-side',eb);j.removeClass(db,'leftColumn');j.removeClass(db,'rightColumn');j.addClass(db,eb=='l'?'leftColumn':'rightColumn');};}else oa=function(db,eb){k.set(r.DS_SIDEORG,db.id,na(db,true));db.setAttribute('data-side',eb);};oa(bb,cb);};function pa(bb){return bb.getAttribute('data-size');}var qa=function(bb,cb){if(ja(bb))return;if(cb){j.addClass(bb,'balancingCapsule');}else j.removeClass(bb,'balancingCapsule');};function ra(bb){if(j.hasClass(bb,'fbTimelineOneColumn')&&bb.prevSibling&&j.hasClass(bb.prevSibling,'fbTimelineOneColumn'))return ca*2;if(j.hasClass(bb,'fbTimelineIndeterminateContent'))return 0;return ca;}function sa(bb,cb){var db=0;if(j.shown(bb)&&!j.hasClass(bb,'placeholderUnit'))if(cb===da){db=k.get(r.DS_HEIGHT,bb.id,null);if(db===null)db=bb.getAttribute('data-calculatedheight');}else db=bb.offsetHeight+ra(bb);if(cb===da&&db===null)db=300;k.set(r.DS_HEIGHT,bb.id,parseInt(db,10));}function ta(bb){var cb=k.get(r.DS_HEIGHT,bb.id,null);return cb;}function ua(bb,cb){if(pa(cb)=='2'){return 0;}else if(na(cb)=='r'){return bb+ta(cb);}else return bb-ta(cb);}function va(bb){var cb=bb.parentNode;if(!cb)return;var db=document.createDocumentFragment(),eb=bb.firstChild;while(eb.firstChild)db.appendChild(eb.firstChild);u.run(cb,l.replace.curry(bb,db));}function wa(bb){for(var cb=0;cb<bb.children.length;cb++){var db=bb.children[cb];if(!db.getAttribute('data-endmarker'))continue;var eb=db.getAttribute('data-endmarker'),fb=db.getAttribute('data-pageindex'),gb=function(){k.set(r.DS_LOADED,bb.id,fb);l.remove(db);h.inform(t.SECTION_FULLY_LOADED,{scrubberKey:eb,pageIndex:fb,capsuleID:bb.id,childCount:bb.children.length});};if(s.getSection(eb)){gb();}else var hb=h.subscribe(t.SECTION_REGISTERED,function(ib,jb){if(jb.scrubberKey===eb){gb();hb.unsubscribe();}});break;}qa(bb,false);h.inform('TimelineCapsule/balanced',{capsule:bb});}function xa(bb,cb,db){while(cb[0])oa(cb.pop(),'l');while(db[0])oa(db.pop(),'r');if(ja(bb))va(bb);wa(bb);}function ya(bb){if(y(fa[bb.id]))return;var cb=ja(bb)?bb.firstChild:bb,db=cb.childNodes.length,eb={},fb={},gb,hb=ca,ib=ca,jb,kb=[];for(var lb=0;lb<db;lb++){gb=cb.childNodes[lb];if(j.hasClass(gb,'fbTimelineUnit')){jb=m.scry(gb,'div.timelineUnitContainer')[0];if(jb)fb[gb.id]=jb.getAttribute('data-time');if(!la(gb)&&j.shown(gb)){if(pa(gb)=='2'){eb[gb.id]=Math.max(hb,ib);hb=ib=eb[gb.id]+ta(gb);}else if(na(gb)=='r'){eb[gb.id]=ib;ib+=ta(gb);}else{eb[gb.id]=hb;hb+=ta(gb);}if(na(gb,true)=='l'||pa(gb)=='2')kb.push(gb.id);}}}for(lb=0;lb<kb.length-1;++lb){var mb=kb[lb],nb=kb[lb+1],ob=eb[mb]+ba,pb=eb[nb];for(var qb in fa[bb.id]){if(ob>pb)break;var rb=fa[bb.id][qb];if(j.shown(rb))continue;if(fb[qb]<=fb[mb]&&fb[qb]>fb[nb]){rb.style.top=ob+"px";ob+=ba;j.show(rb);}}}}function za(bb,cb){var db=q.byAttribute(bb,'data-size');if(db){if(j.hasClass(bb.parentNode,'timelineReportContent')){cb(bb);}else cb(db);aa.balanceCapsule(q.byClass(db,'fbTimelineCapsule'));}}function ab(bb){var cb=0;for(var db=0;db<bb.childNodes.length;db++)if(j.hasClass(bb.childNodes[db],'fbTimelineUnit'))cb++;return cb;}return {getUnitsWithTime:function(bb){return m.scry(bb,'div.timelineUnitContainer').filter(function(cb){return (cb.parentNode.parentNode===bb&&cb.getAttribute('data-time'));});},removeUnit:function(bb){za(bb,function(cb){l.remove(cb);});},hideUnit:function(bb){za(bb,function(cb){j.addClass(cb,'fbTimelineColumnHidden');});},undoHideUnit:function(bb,cb){l.remove(q.byClass(cb,'hiddenText'));za(bb,function(db){j.removeClass(db,'fbTimelineColumnHidden');});},unplacehold:function(bb){var cb=g(bb);cb.style.top=null;j.removeClass(cb,'visiblePlaceholder');j.removeClass(cb,'placeholder');var db=q.byClass(cb,'fbTimelineCapsule');delete fa[db.id][bb];aa.balanceCapsule(db);},scrollToCapsule:function(bb){if(!ia.hasOwnProperty(bb.id)){var cb=x.getElementPosition(bb.parentNode);n.scrollTo(new x(x.getScrollPosition().x,cb.y-r.SUBSECTION_SCROLL_TO_OFFSET,'document'));ia[bb.id]=true;}},setFirstUnit:function(bb){var cb=true,db=bb.childNodes.length;for(var eb=0;eb<db;eb++){var fb=bb.childNodes[eb];if(fb.id.indexOf('tl_unit_')===0)if(cb){cb=false;j.addClass(fb,'firstUnit');}else{j.removeClass(fb,'firstUnit');break;}}},balanceCapsule:function(bb,cb){if(!bb)return;if(bb.getAttribute('data-layout')=='fixed'){v.getInstance('balanceCapsuleFixed').debounce(aa.balanceFixed.curry(bb,cb),bb.id);}else v.getInstance('balanceCapsule').throttle(aa.balance.curry(bb,0),bb.id);},balanceFixed:function(bb,cb){if(!bb)return;var db=0,eb,fb=document.createDocumentFragment(),gb=[],hb=[],ib=[],jb=false,kb=cb&&cb.heights_action;if(kb!==ea&&(w.chrome()||w.safari()))j.toggleClass(bb,'webkitFix');for(var lb=0;lb<bb.childNodes.length;lb++){eb=bb.childNodes[lb];if(ka(eb)){continue;}else if(ja(eb)){i(eb.firstChild.childNodes).forEach(function(sb){sa(sb,kb);});continue;}sa(eb,kb);if(na(eb,true)=='r'){hb.push(eb);}else gb.push(eb);ib.push(eb);if(pa(eb)!='2')if((db>0&&na(eb)=='r')||(db<0&&na(eb)=='l'))jb=true;db=ua(db,eb);}var mb=[],nb=[],ob=[];m.scry(bb,'li.fbTimelineBalancer').forEach(function(sb){var tb=i(sb.firstChild.childNodes);if(sb.getAttribute('data-nonunits')){ob=ob.concat(tb);}else if(na(sb)=='left'){mb=mb.concat(tb);}else if(na(sb)=='right')nb=nb.concat(tb);});if(jb){bb.style.minHeight=bb.offsetHeight;gb.forEach(function(sb){if(pa(sb)!='2')oa(sb,'l');});hb.forEach(function(sb){if(pa(sb)!='2')oa(sb,'r');});var pb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,gb));pb.setAttribute('data-side','left');l.prependContent(bb,pb);mb=gb.concat(mb);var qb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,hb));qb.setAttribute('data-side','right');l.prependContent(bb,qb);nb=hb.concat(nb);db=0;}while((db>=0&&mb.length)||(db<0&&nb.length)){if(db>=0){eb=mb.shift();}else eb=nb.shift();fb.appendChild(eb);db=ua(db,eb);}while(ob.length)fb.appendChild(ob.shift());bb.appendChild(fb);m.scry(bb,'li.fbTimelineBalancer').forEach(function(sb){if(!sb.firstChild.childNodes.length)l.remove(sb);});var rb;if(cb&&cb.tail_balance){rb=cb.tail_balance;}else if(k.get(r.DS_TAILBALANCE,bb.id))rb=r.FIXED_SIDE_BOTH;if(rb)db=aa.tailBalance(bb,db,rb);if(jb){ib.forEach(function(sb){if(sb.parentNode!==bb){bb.appendChild(sb);db=ua(db,sb);}});bb.style.minHeight=null;}k.set(r.DS_COLUMN_HEIGHT_DIFFERENTIAL,q.byClass(bb,'fbTimelineSection').id,db);fa[bb.id]={};m.scry(bb,'li.placeholderUnit').forEach(function(sb){fa[bb.id][sb.id]=sb;});ya(bb);wa(bb);if(kb===da){cb.heights_action=ea;z(function(){z(aa.balanceCapsule.curry(bb,cb));});}},tailBalance:function(bb,cb,db){if(!bb)return cb;var eb=[],fb=[],gb=[],hb=[];m.scry(bb,'li.fbTimelineBalancer').forEach(function(jb){var kb=i(jb.firstChild.childNodes);if(jb.getAttribute('data-nonunits')){hb=hb.concat(kb);}else if(na(jb)=='left'){fb=fb.concat(kb);}else if(na(jb)=='right')gb=gb.concat(kb);eb=eb.concat(kb);});if((db==r.FIXED_SIDE_RIGHT&&fb.length)||(db==r.FIXED_SIDE_LEFT&&gb.length))return cb;var ib=document.createDocumentFragment();if(eb)while(eb.length){if(pa(eb[0])!='2')if(cb>=0){oa(eb[0],'l');}else oa(eb[0],'r');cb=ua(cb,eb[0]);ib.appendChild(eb.shift());}bb.appendChild(ib);m.scry(bb,'li.fbTimelineBalancer').forEach(function(jb){if(!jb.firstChild.childNodes.length)l.remove(jb);});k.set(r.DS_TAILBALANCE,bb.id,true);return cb;},balance:function(bb,cb,db){if(!bb)return;if(!fa[bb.id])fa[bb.id]={};var eb=ja(bb)?bb.firstChild:bb,fb=eb.childNodes.length,gb=[],hb=[];if(w.chrome()||w.safari())j.toggleClass(bb,'webkitFix');for(var ib=0;ib<fb;ib++)sa(eb.childNodes[ib]);var jb=false;for(ib=0;ib<fb;ib++){var kb=eb.childNodes[ib];if(ka(kb))continue;var lb=(cb>=0),mb=kb.nextSibling;if(ma(kb)){if(na(kb)=='r'){if(cb>0)if(mb&&pa(mb)!='2'){var nb=[kb];while(mb&&ma(mb)&&na(mb)=='r'){nb.push(mb);mb=mb.nextSibling;}if(mb){if(ja(mb)){var ob=mb.firstChild;l.prependContent(ob,nb);sa(ob);fb-=nb.length;}else l.insertBefore(kb,mb);ib--;}continue;}cb+=ta(kb);}else cb-=ta(kb);}else if(kb.id&&(fa[bb.id][kb.id]||la(kb))){fa[bb.id][kb.id]=kb;continue;}else if(ja(kb)){cb=aa.balance(kb,cb);}else if(pa(kb)=='2'){if(mb&&ma(mb)&&na(mb)=='r'&&cb<=0){l.insertBefore(kb,mb);ib--;}else{lb=true;cb=0;}}else if(lb){gb.push(kb);cb-=ta(kb);}else{var pb=false;if(!jb){while(mb&&(!ma(mb)||na(mb)!='r'))mb=mb.nextSibling;if(mb){l.insertBefore(kb,mb);ib--;pb=true;}else jb=true;}if(!pb){hb.push(kb);cb+=ta(kb);}}}qa(bb,true);if(db&&db.nothrottle){xa(bb,gb,hb);ya(bb);}else{clearTimeout(ha[bb.id]);ha[bb.id]=setTimeout(function(){v.getInstance('positionUnits').debounce(xa.curry(bb,gb,hb),bb.id);delete ha[bb.id];},50);clearTimeout(ga[bb.id]);ga[bb.id]=setTimeout(function(){v.getInstance('adjustPlaceholders').debounce(ya.curry(bb),bb.id);delete ga[bb.id];},150);}return cb;}};})();e.exports=a.TimelineCapsule||aa;});
__d("legacy:TimelineCapsule",["TimelineCapsule"],function(a,b,c,d){a.TimelineCapsule=b('TimelineCapsule');},3);
__d("legacy:TimelineController",["TimelineController"],function(a,b,c,d){a.TimelineController=b('TimelineController');},3);
__d("TimelineDrag",["event-extensions","ArbiterMixin","Class","Locale","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties');function m(n,o,p){p=p||{};this._listenOn=p.listenOn;this._offsetInput=o;this._defaultOffset=p.default_offset;this._killClicks=p.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(n,p);}l(m.prototype,g,{setPicture:function(n,o){if(!n)return false;o=o||{};this._picture=n;this._defaultOffset=o.default_offset;if(o.vertical!==undefined)this._vertical=o.vertical;if(this._vertical){if(o.height)this._containerHeight=o.height;this._offsetType='top';this._eventCoord='y';}else{if(o.width)this._containerWidth=o.width;this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=Event.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var n=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=Event.listen(n,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.width;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=Event.listen(n,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var n=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=n-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[Event.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),Event.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var n=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=n+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=n;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(n){n.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(n){if(this._RTLXSwitch){n=Math.max(0,Math.min(n,-this._maxOffset));}else n=Math.min(0,Math.max(n,this._maxOffset));j.set(this._picture,this._offsetType,n+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=m;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","Vector","TimelineController","TimelineDrag","Style","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('Vector'),n=b('TimelineController'),o=b('TimelineDrag'),p=b('Style'),q=b('$'),r=b('copyProperties'),s=b('ge');function t(u,v,w){this.root=q('fbProfileCover');this._parentSection=k.byClass(this.root,'fbTimelineSection');this._coverHeight=v;this.cover=i.find(this.root,'.cover');t.instance=this;this.previewing=w;this.editing=false;if(w){this.updateCoverImage(w);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));if(this.previewing)this.editMode();n.register(n.COVER,this);}t.instance=null;t.getInstance=function(){return t.instance;};r(t.prototype,{showLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.addClass(u,'opaquedLoading');},hideLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.removeClass(u,'opaquedLoading');},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var u=i.scry(this._coverImage,'.coverWrap')[0];if(u)this._originalOffset=p.get(i.find(u,'.coverPhotoImg'),'top');h.addClass(this._parentSection,'fbEditCover');l.scrollTo(this.root);if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var v=i.scry(this._coverImage,'.coverPhotoImg')[0];if(v)this._createDragger();this.editing=true;},_expandCover:function(u){u-=1;this.cover.style.marginTop='0px';if(u!=m.getScrollPosition().y){window.scrollBy(0,u);n.coverHasExpanded(u);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;i.find(this.root,'input.hiddenVideoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();},_createDragger:function(){this._timelineDrag=new o(i.find(this.root,'.coverImage .coverPhotoImg'),i.find(this.root,'input.photoOffsetInput'),{height:this._coverHeight,listenOn:this.cover,vertical:true,killClicks:true});},updateCoverImage:function(u,v,w){this.videoID=w;if(v)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=u;i.find(this.root,'input.hiddenVideoID').value=w||null;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(v)i.replace(i.find(this.root,'.coverImage'),j(v));if(this._timelineDrag){this._timelineDrag.setPicture(i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'));}else this._createDragger();},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)p.set(i.find(this._coverImage,'.coverPhotoImg'),'top',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];this._exitEditMode();},isInEditMode:function(){return this.editing;}});e.exports=t;});
__d("TimelineFriendsNavHovercard",["event-extensions","Hovercard","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Hovercard'),h=b('UserAgent');function i(event){var k=event.getTarget();g.processNode(k)&&event.stop();}var j={init:function(k){if(h.ie()<7)return;Event.listen(k,'mouseover',i);}};e.exports=j;});
__d("legacy:TimelinePerfConfig",["TimelinePerfConfig"],function(a,b,c,d){a.TimelinePerfConfig=b('TimelinePerfConfig');},3);
__d("TimelineStickyHeader",["Arbiter","CSS","DOM","TimelineController","ViewportBounds"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('TimelineController'),k=b('ViewportBounds'),l=false,m=false,n,o,p,q,r={VISIBLE:'TimelineStickyHeader/visible',ADJUST_WIDTH:'TimelineStickyHeader/adjustWidth',init:function(s){if(l)return;l=true;n=s;o=i.find(s,'div.name');p=i.find(s,'div.actions');q=k.addTop(function(){return m?s.offsetTop+s.scrollHeight:0;});j.register(j.STICKY_HEADER,r);},reset:function(){l=false;m=false;n=null;o=null;p=null;q.remove();q=null;},toggle:function(s){h.conditionClass(n,'fbTimelineStickyHeaderHidden',!s);if(s!==m){m=s;g.inform(r.VISIBLE,s);}},adjustWidth:function(){g.inform(r.ADJUST_WIDTH,o,g.BEHAVIOR_STATE);},getRoot:function(){return n;},setActions:function(s){if(l&&s){i.setContent(p,s);p=s;}}};e.exports=a.TimelineStickyHeader||r;});
__d("legacy:TimelineStickyHeader",["TimelineStickyHeader"],function(a,b,c,d){a.TimelineStickyHeader=b('TimelineStickyHeader');},3);
__d("TimelineLogging",["TimelineController","reportData"],function(a,b,c,d,e,f){var g=b('TimelineController'),h=b('reportData'),i=false,j=0,k=null,l={init:function(m){if(i)return;j=m;g.register(g.LOGGING,this);},reset:function(){i=false;j=0;k=null;},log:function(m,n){n.profile_id=j;h(m,{gt:n});},logSectionChange:function(m,n){var o={timeline_section_change:1,key:m};if(k&&m==k){o.timeline_scrubber=1;k=null;}l.log('timeline',o);},logScrubberClick:function(m){k=m;}};e.exports=l;});
__d("TimelineNavigation",["event-extensions","Arbiter","DOM","CSS","PageTransitions","Parent","TimelineController","TimelineURI","URI","$","createArrayFrom","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('CSS'),j=b('PageTransitions'),k=b('Parent'),l=b('TimelineController'),m=b('TimelineURI'),n=b('URI'),o=b('$'),p=b('createArrayFrom'),q=b('ge'),r=4,s=110,t=20,u=119,v=328,w=10,x=3,y=false,z=21,aa,ba,ca,da=[],ea=[],fa,ga=0,ha,ia=0,ja=0,ka,la=r,ma=false,na=false,oa=null,pa,qa=false,ra,sa,ta=false;function ua(ib,jb,kb){if(!jb.firstChild){h.remove(jb);return;}ea.push(jb);xa(kb.recent);i.removeClass(k.byTag(jb,'li'),'empty');if(fa&&(ia>r||ja>0))i.removeClass(fa,'notready');wa();if(kb.async){bb();db();}}function va(ib,jb,kb){h.remove(k.byTag(jb,'li'));if(!kb.async){ka++;}else{ia--;bb();db();}wa();}function wa(){var ib=fa?0:z;if(ia<=r){var jb=v+u*Math.max(0,r-ia)+ib;ha.style.width=jb+'px';la=ia;ya();}}function xa(ib){if(ib){ja++;}else ia++;ya();}function ya(){if(!ra)return;var ib=Math.max(0,ia-r)+ja;if(ga&&fa){h.setContent(ga,ib===0?" ":ib);i.conditionClass(fa,'fbTimelineMoreButtonZero',ib===0);if(!ma)i.conditionShow(fa,ib>0);}}function za(){var ib=h.scry(o('fbTimelineNavTopRow'),'li.tile'),jb=0,kb=0,lb=Math.max(0,r-la),mb=false;for(var nb=0;nb<ib.length;nb++){if(ib[nb]==ha||ib[nb]==fa)continue;mb=((jb+lb)%r===0);i.conditionClass(ib[nb],'leftMost',(jb!==0&&mb));if(!i.hasClass(ib[nb],'empty'))kb=jb;jb++;}mb=((kb+1+lb)%r===0);var ob=ib.length-1-lb;if(mb){if(ma&&(kb+1+lb)/r<x){ob=Math.min(ob,kb+r);na=true;}else ob=kb;}else{var pb=((kb+1+lb)%r);ob=kb+(r-pb);na=false;}nb=0;for(nb=0;nb<=ob;nb++)if(ib[nb]&&(ib[nb]==ha||ib[nb]==fa)){ob++;}else ib[nb]&&i.hasClass(ib[nb],'empty')&&i.removeClass(ib[nb],'hidden_elem');}function ab(ib,jb,kb){var lb=h.scry(ib,'li.tile');if(!jb)jb=0;var mb=false;for(var nb=jb;nb<lb.length;nb++){mb=((nb-kb)%r===0);var ob=lb[nb];i.conditionClass(ob,'leftMost',mb);if(i.hasClass(ob,'empty'))i.removeClass(ob,'hidden_elem');}}function bb(){za();var ib=q('fbTimelineNavSecondaryRow');ib&&ab(ib,0,0);}function cb(){if(!fa)return;if(i.hasClass(fa,'notready'))return;i.toggleClass(fa,'fbTimelineMoreButtonOpen');var ib=q('fbRecentAppTitle');ib&&i.conditionClass(ib,'hidden_elem',ja===0);if(i.hasClass(fa,'fbTimelineMoreButtonOpen')){bb();}else ya();db();}function db(){if(fa&&!i.hasClass(fa,'fbTimelineMoreButtonOpen')){aa.style.height='';i.removeClass(aa,'expanded');}else{var ib=ia+(r-la),jb=((ja>0)?w:0)+s*(Math.ceil(ja/r))+s*(Math.ceil(ib/r))+s*(na?1:0)+t;i.addClass(aa,'expanded');aa.style.height=jb+'px';}}function eb(ib){var jb=ib==m.TIMELINE_KEY||ib==m.WALL_KEY,kb=k.byClass(aa,'fbTimelineTopSectionBase'),lb=q('timeline_tour_toolbar');if(fa){i.removeClass(fa,'fbTimelineMoreButtonOpen');db();}lb&&i.conditionShow(lb,jb);if(kb)i.conditionClass(kb,'collapsedHead',!jb);}function fb(event){if(ta)return true;if(!k.byTag(event.getTarget(),'a')){var ib=h.find(ha,'a.title');j.go(ib.href);}}function gb(){if(fa)(function(){fa.removeAttribute('ajaxify');fa.removeAttribute('rel');}).defer();oa&&oa.remove();}var hb={UPDATE_PAGE:'TimelineNavigation/updatePage',init:function(ib,jb,kb,lb){if(y)return;y=true;aa=ib;fa=jb;ba=n.getRequestURI();ha=h.find(aa,'li.about');eb(l.getCurrentKey());ma=lb;g.inform(hb.UPDATE_PAGE);if(fa){ga=h.find(fa,'div.text');oa=Event.listen(fa,'click',gb);}pa=o('fbTimelineNavigationLoadContainer');h.appendContent(o('content'),pa);sa=Event.listen(ha,'click',fb);da.forEach(function(nb){if(!nb[2].remove){ua.apply(this,nb);}else va.apply(this,nb);});da=[];var mb=k.byClass(ib,'fbTimelineSection');if(mb)h.scry(mb,'ul.uiButtonGroup').forEach(function(nb){p(nb.childNodes).forEach(function(ob){ob.childNodes.length||h.remove(ob);});if(nb.firstChild){i.addClass(nb.firstChild,'firstItem');}else h.remove(nb);});l.register(l.NAV,hb);},reset:function(){sa&&sa.remove();sa=null;ra&&ra.remove();ra=null;y=false;aa=null;ca=null;ea=[];fa=null;ga=null;ha=null;ia=0;ja=0;ka=0;la=r;ma=false;na=false;pa=null;qa=false;ta=false;},initializeMorePager:function(){if(ra)return;if(fa)ra=Event.listen(fa,'click',cb);},registerNav:function(ib,jb,kb){y?(kb.remove?va.apply(this,arguments):ua.apply(this,arguments)):da.push(arguments);},redraw:function(){bb();db();},setEditMode:function(ib){ta=ib;}};e.exports=hb;});
__d("TimelineSideAds",["event-extensions","function-extensions","Arbiter","CSS","DOM","StickyController","TimelineController","UIPagelet","URI","Vector","debounce","ge"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('StickyController'),k=b('TimelineController'),l=b('UIPagelet'),m=b('URI'),n=b('Vector'),o=b('debounce'),p=b('ge'),q=2,r=3,s=75,t='data-height',u=310,v=45,w=30000,x=0,y=false,z,aa,ba,ca,da=[],ea,fa=false,ga,ha=Infinity,ia=5,ja=false,ka,la,ma,na,oa,pa=false,qa=[],ra;function sa(kb,lb,mb){var nb=0;if(p('pagelet_timeline_friends'))nb+=u;if(lb)nb+=lb.getHeight();if(!k.fixedAds()&&!nb)return;kb-=nb;var ob=0;for(var pb=0;pb<mb;pb++)ob+=cb(pb);if(lb)if(kb<ob){kb+=lb.fold(ob-kb);}else if(kb>ob)kb-=lb.unfold(kb-ob);return kb;}function ta(){var kb=aa.cloneNode(true);kb.id='';var lb=true;i.scry(kb,'div.ego_unit').forEach(function(mb){if(lb){lb=false;}else i.remove(mb);});h.addClass(kb,'fixed_elem');return kb;}function ua(){if(!k.pageHasScrubber(ea)){ya(ia);ab();}else if(la){za(aa,false);var kb=ma;ma&&i.remove(ma);ma=ta();if(kb)hb();ya(k.sidebarInitialized()&&fa?r:q);ab();if(!ga){var lb=k.getCurrentScrubber();if(lb){gb(lb.getRoot(),lb.getOffset());}else{var mb=p('timeline_side_friends');if(mb)gb(mb,v);}}ga&&ga.start();}else jb.adjustAdsToFit();}function va(){var kb=p('pagelet_timeline_friends');if(kb)h.conditionClass(kb,'fixed_elem',!la);}function wa(){if(ma){i.remove(ma);ma=null;}if(ga){ga.stop();ga=null;}if(k.fixedAds()){h.conditionClass(aa,'fixed_elem',!la);h.conditionClass(aa,'fbTimelineTopAlignedAds',!k.pageHasScrubber(ea));}else h.conditionClass(aa,'fixed_elem',!la&&k.pageHasScrubber(ea));va();}function xa(kb){var lb=n.getViewportDimensions().y,mb=k.getCurrentScrubber(),nb=mb?mb.getOffset():k.SCRUBBER_DEFAULT_OFFSET,ob=lb-nb-s;if(mb||k.fixedAds()||p('pagelet_timeline_friends'))return sa(ob,mb,kb);}function ya(kb){ca=Math.min(kb,da.length);for(var lb=0;lb<da.length;lb++)za(da[lb],lb>=ca);za(aa,ca===0);}function za(kb,lb){h.conditionClass(kb,'fbTimelineSideAdsOffScreen',lb);kb.setAttribute('aria-hidden',lb?'true':'false');}function ab(){if(!na)return;for(var kb=ca-1;kb>=0;--kb){if(ga&&ga.isFixed()&&((kb!==0)||(ma&&!h.shown(ma))))continue;var lb=i.find(da[kb],'div.fbAdUnit'),mb=lb.getAttribute('data-ad'),nb=JSON.parse(mb).adid;if(!na[nb])return;var ob=i.create('iframe',{src:m('/ai.php').addQueryData({aed:na[nb]}),width:0,height:0,frameborder:0,scrolling:'no',className:'fbEmuTracking'});ob.setAttribute('aria-hidden','true');i.appendContent(aa,ob);delete na[nb];}}function bb(kb){var lb=0;while(kb>0&&lb<ia){kb-=cb(lb);if(kb>=0)lb++;}return lb;}function cb(kb){var lb=da[kb];if(!lb)return 0;if(!lb.getAttribute(t))db(lb);return parseInt(lb.getAttribute(t),10);}function db(kb){kb.setAttribute(t,kb.offsetHeight);}function eb(){for(var kb=0;kb<da.length;kb++){var lb=da[kb];if(!lb)continue;db(lb);}}function fb(){da=i.scry(aa,'div.ego_unit');var kb=da.length;if(!kb)return;ja=kb;ua();var lb=function(mb){db(mb);ja=--kb;jb.adjustAdsToFit();if(!ja)ha=Date.now();};da.forEach(function(mb){function nb(){lb.curry(mb).defer();}var ob=i.scry(mb,'img.img')[0];if(ob.complete){nb();}else Event.listen(ob,{load:nb,error:nb,abort:nb});});}function gb(kb,lb){ga=new j(kb,lb,function(mb){if(mb){hb();}else{i.remove(ma);ab();}});if(ma)ga.start();}function hb(){i.insertAfter(aa,ma);ib();}function ib(){h.conditionShow(ma,cb(0)<=xa(1)&&!h.hasClass(document.documentElement,'tinyViewport'));}var jb={init:function(kb,lb,mb){if(y)return;ia=mb.max_ads;z=mb.refresh_delay;w=mb.refresh_threshold;y=true;ba=lb;aa=kb;jb.adjustAdsType(k.shouldShowWideAds());oa=g.subscribe(['UFI/CommentAddedActive','UFI/CommentDeletedActive','UFI/LikeActive','Curation/Action','ProfileBrowser/LoadMoreContent'],jb.loadAdsIfEnoughTimePassed);ra=o(jb.loadAdsIfEnoughTimePassed,z,this,true);if(mb.mouse_move){qa.push(Event.listen(window,'mousemove',ra));qa.push(Event.listen(window,'scroll',ra));qa.push(Event.listen(window,'resize',ra));}k.register(k.ADS,jb);},setShortMode:function(kb,lb){la=lb!=='map'&&kb&&k.pageHasScrubber(lb);},start:function(kb){na=kb;ka=null;fb();},updateCurrentKey:function(kb){if(kb==ea)return;ea=kb;wa();},loadAds:function(kb){if(ja||ka)return;ha=Infinity;ka=l.loadFromEndpoint('WebEgoPane',aa.id,{pid:33,data:[ba,false,'timeline_'+kb,la?r:ia,++x]},{crossPage:true,bundle:false});},registerScrubber:function(kb){h.conditionClass(kb.getRoot(),'fixed_elem',!la);va();if(la)gb(kb.getRoot(),kb.getOffset());!ka&&jb.adjustAdsToFit();},loadAdsIfEnoughTimePassed:function(){if((Date.now()-ha>=w)&&!h.hasClass(document.documentElement,'tinyViewport')&&(!ga||ga.isFixed())&&(!na||!na[da[0]]))jb.loadAds(ea);jb.adjustAdsToFit();},adjustAdsType:function(kb){if(kb!=fa){h.conditionClass(aa,'fbTimelineVerticalAds',!kb);ma&&h.conditionClass(ma,'fbTimelineVerticalAds',!kb);fa=kb;eb();jb.adjustAdsToFit();var lb=p('timeline_side_friends');if(lb)h.conditionClass(lb,'fbTimelineVerticalSideFriends',!kb);var mb=p('rightColContent');if(mb)h.conditionClass(mb,'fbTimelineWideRightCol',kb);}},adjustAdsToFit:function(){if(!aa||pa)return;pa=true;var kb=fa?r:q;if(la){if(ga&&ma){ga.handleScroll();if(ga.isFixed()){h.conditionShow(ma,cb(0)<=xa(1)&&!h.hasClass(document.documentElement,'tinyViewport'));}else ya(kb);ab();}}else{var lb=xa(kb);if(typeof lb!=='undefined'){ya(bb(lb));if(!ja)ab();}}pa=false;},reset:function(){ga&&ga.stop();ka&&ka.cancel();da=[];fa=false;aa=null;ga=null;ka=null;x=0;ja=null;la=null;ma=null;ea=null;ha=Infinity;y=false;oa&&g.unsubscribe(oa);oa=null;qa.forEach(function(kb){kb.remove();});qa=[];ra&&ra.reset();}};e.exports=a.TimelineSideAds||jb;});
__d("TimelineStickyHeaderNav",["array-extensions","event-extensions","function-extensions","Arbiter","ButtonGroup","CSS","DOM","Parent","Selector","Style","TimelineController","URI","UserAgent","Vector","ge","tx"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ButtonGroup'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Selector'),m=b('Style'),n=b('TimelineController'),o=b('URI'),p=b('UserAgent'),q=b('Vector'),r=b('ge'),s=b('tx'),t=false,u,v,w,x,y,z,aa,ba,ca,da,ea,fa={},ga={},ha=[],ia=false,ja=[],ka=[],la=[],ma=[],na=[],oa=["enero","febrero","marzo","abril","mayo","junio","Julio","agosto","Septiembre","octubre","noviembre","diciembre"];function pa(event){var eb=k.byTag(event.getTarget(),'a');if(eb){n.navigateToSection(eb.getAttribute('data-key'));event.prevent();}}function qa(eb,fb){var gb=l.getValue(fb);if(gb==='allStories')n.getSection(eb).expandSubSections();if(gb!=='activityLog')ra(fb);}function ra(eb){bb(eb,'highlights');bb(eb,'allStories');var fb=j.find(eb,'li.separator');i.conditionShow(fb,fb.previousSibling);}function sa(eb){if(ca[eb]&&!v.custom_subsection_menu){ya(eb);}else va();n.adjustStickyHeaderWidth();}function ta(eb,fb){var gb=fb.key;if(da[gb]){za(gb);sa(gb);}}function ua(eb,fb){var gb=fb.scrubberKey;za(gb);if(w===gb)sa(gb);}function va(){x.hideItem(aa);}function wa(eb){var fb=eb.split('_');return oa[fb.pop()-1];}function xa(eb){var fb=ba[eb],gb=ca[eb];if(!fb&&gb){fb=ba[eb]=aa.cloneNode(true);var hb=j.scry(fb,'li.activityLog a')[0];if(hb)hb.href=o(hb.href).addQueryData({key:eb});var ib=n.getCurrentScrubber();if(gb.length)i.show(j.find(fb,'li.separator'));for(var jb=0;jb<gb.length;jb++){var kb=gb[jb].scrubberKey,lb=ib?ib.getLabelForSubnav(gb[jb].parentKey,kb):lb=wa(kb);if(lb)ab(fb,{key:kb,label:lb});}if(cb()){ra(fb);l.setSelected(fb,j.scry(fb,'option')[1].value,true);}na.push(l.listen(fb,'change',qa.curry(eb,fb)));la.push(Event.listen(fb,'click',pa));}return fb;}function ya(eb){var fb=xa(eb);j.insertAfter(aa,fb);i.hide(aa);for(var gb in ba){var hb=ba[gb];i.conditionShow(hb,hb===fb);}x.showItem(aa);}function za(eb){ca[eb]=n.getSection(eb).subSections;}function ab(eb,fb){var gb=j.create('a',{href:'#',rel:'ignore',className:'itemAnchor',tabIndex:0},j.create('span',{className:'itemLabel fsm'},fb.label));gb.setAttribute('data-key',fb.key);gb.setAttribute('aria-checked',false);var hb=j.create('li',{className:'uiMenuItem uiMenuItemRadio uiSelectorOption'},gb);hb.setAttribute('data-label',fb.label);var ib=j.find(eb,'ul.uiMenuInner'),jb=j.create('option',{value:fb.key},fb.label),kb=j.find(eb,'select');if(fb.key==='recent'){j.prependContent(ib,hb);j.insertAfter(kb.options[0],jb);}else{j.appendContent(ib,hb);j.appendContent(kb,jb);}}function bb(eb,fb){var gb=j.scry(eb,'li.uiMenuItem');if(!gb)return;for(var hb=0;hb<gb.length;hb++){var ib=gb[hb];if(i.hasClass(ib,fb)||ib.firstChild.getAttribute('data-key')==fb){j.remove(ib);break;}}var jb=j.find(eb,'select'),kb=j.scry(jb,'option');for(hb=0;hb<kb.length;hb++)if(kb[hb].value===fb){j.remove(kb[hb]);return;}}function cb(){return n.getCurrentKey()==='allactivity'||n.getCurrentKey()==='approve';}var db={init:function(eb,fb){if(t)return;t=true;u=eb;v=fb||{};y=j.find(u,'div.pageMenu');z=j.find(u,'div.sectionMenu');aa=j.find(u,'div.subsectionMenu');ea=j.find(y,'li.uiMenuSeparator');x=h.getInstance(y);ba={};ca={};da={};db.adjustMenuHeights();n.register(n.STICKY_HEADER_NAV,db);if(r('pagelet_timeline_friends'))db.addTimePeriods(n.getSectionKeys());ka.forEach(function(gb){gb();});},reset:function(){t=false;v={};ha=[];fa={};ga={};ia=false;ja=[];u=null;y=null;z=null;aa=null;ea=null;ba={};ca={};da={};while(la.length)la.pop().remove();ma.forEach(g.unsubscribe);na.forEach(l.unsubscribe.bind(l));},addTimePeriods:function(eb){if(!eb.length)return;if(v.pull_from_scrubber){j.setContent(j.find(z,'ul.uiMenuInner'),'');j.remove(j.find(z,'select').children[1]);while(eb.length){var fb=eb.shift();fb&&db.addTimePeriod(fb);}x.showItem(z);}var gb=l.getSelectorMenu(z);la.push(Event.listen(gb,'click',pa));var hb=cb()?n.SECTION_REGISTERED:n.SECTION_LOADED,ib=cb()?ua:ta;ma.push(g.subscribe(hb,ib));},addTimePeriod:function(eb){var fb=n.getCurrentScrubber();if(!fb)return;var gb=fb.getLabelForNav(eb);if(!gb)return;ab(z,{key:eb,label:gb});var hb=j.find(z,'ul.uiMenuInner');if(eb==='recent'||hb.children.length<2)l.setSelected(z,eb,true);},updateSection:function(eb,fb){if(fb){var gb=xa(eb);if(gb){l.setSelected(gb,fb);ra(gb);}else w=eb;}else{da[eb]=true;za(eb);}l.setSelected(z,eb,true);sa(eb);},adjustMenuHeights:function(){if(p.ie()<=7)return;[y,z].forEach(function(eb){var fb='';if(!i.hasClass(document.documentElement,'tinyViewport')){fb=q.getViewportDimensions().y-q.getElementDimensions(r('blueBar')).y-80;fb+='px';}m.set(j.find(eb,'ul.uiMenuInner'),'maxHeight',fb);});},initPageMenu:function(eb,fb){if(!t){ka.push(db.initPageMenu.curry(eb,fb));return;}function gb(hb,ib){hb.forEach(function(jb){var kb=ga[jb]=j.create('li');i.hide(kb);ib?j.insertBefore(ea,kb):j.appendContent(j.find(y,'ul.uiMenuInner'),kb);});}gb(eb,true);gb(fb,false);fa.info=j.scry(y,'li')[0];ha=fb;ia=true;if(ja.length)ja.forEach(function(hb){db.registerPageMenuItem(hb.key,hb.item);});},registerPageMenuItem:function(eb,fb){if(!ia){ja.push({key:eb,item:fb});return;}if(ga[eb]){j.replace(ga[eb],fb);fa[eb]=fb;delete ga[eb];if(ha.indexOf(eb)>=0)i.show(ea);}},removeTimePeriod:function(eb){bb(z,eb);}};e.exports=db;});
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("HubsTypeaheadView",["Class","ContextualTypeaheadView","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ContextualTypeaheadView'),i=b('copyProperties');function j(k,l){this.parent.construct(this,k,l);}g.extend(j,h);i(j.prototype,{render:function(k,l,m){if(this.alwaysRender&&k!==''){var n=k.toLowerCase().trim(),o=false;for(var p=0;p<l.length;p++)if(n==l[p].text.toLowerCase()){o=true;break;}if(!o)l.push({text:k,type:'calltoaction'});}return this.parent.render(k,l,m);}});e.exports=j;});
__d("TypeaheadSetPhotoOnSelect",["event-extensions","function-extensions","CSS","DOM","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('CSS'),h=b('DOM'),i=b('copyProperties');function j(k){this._typeahead=k;}i(j.prototype,{_eventListener:null,_subscription:null,enable:function(){var k=h.scry(this._typeahead.getElement(),'.photo')[0];if(k){if(!h.isNodeOfType(k,'img')){var l=h.create('img',{className:k.className});h.replace(k,l);k=l;}var m=g.hide.curry(k),n=g.show.curry(k);this._eventListener=Event.listen(k,{load:n,error:m,abort:m});this._subscription=this._typeahead.subscribe('select',function(o,p){var q=p.selected.photo||this._typeahead.view.fallbackPhoto;q?k.setAttribute('src',q):m();}.bind(this));}},disable:function(){this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=j;});
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d){var e=b('TypeaheadSetPhotoOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(f){f.enableBehavior(e);};},3);
function TimelineAggregateMapUnitStatic(){}copy_properties(TimelineAggregateMapUnitStatic.prototype,{THROBBER_OFFSET_X:10,THROBBER_OFFSET_Y:5,init:function(a,b,c,d,e,f,g,h){var i=$(b);handler=function(){var j={map_id:a,start:c,end:d,profile_id:e,hash:f,unit_type:g};if(h)j.viewas=h;new AsyncRequest().setURI('/ajax/timeline/map_unit/dynamic').setData(j).send();CSS.addClass(i,'aero');var k=DOM.find(i,'.fbTimelineAggregatedMapUnitSeeAllText'),l=Vector2.getElementPosition(k),m=Vector2.getElementDimensions(k),n=Vector2.getElementPosition($(a)),o=l.add(m.mul(.5)).sub(new Vector2(this.THROBBER_OFFSET_X,this.THROBBER_OFFSET_Y)).sub(n),p=DOM.find($(a),'.fbTimelineAggregatedMapUnitThrobber');CSS.setStyle(p,'left',o.x+'px');CSS.setStyle(p,'top',o.y+'px');CSS.show(p);}.bind(this);Event.listen(i,'click',handler);}});
function TimelineCoverDisclaimer(a,b,c){if(TimelineCoverDisclaimer.displayed===undefined){TimelineCoverDisclaimer.displayed=true;}else return;new Dialog().setModal(true).setTitle(a).setBody(b).setButtonsMessage(c).setButtons(Dialog.OK).show();}
__d("TimelineBackdatedComposer",["Arbiter","Bootloader","CSS","DOM","LayerHideOnBlur","Run","TimelineComposerUtilities","TimelineNavigation"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('LayerHideOnBlur'),l=b('Run'),m=b('TimelineComposerUtilities'),n=b('TimelineNavigation'),o;function p(){q();r();}function q(){o.hide();}function r(){h.loadModules(['TimelineMLE'],function(t){var u=t.getFlyout();if(u&&i.hasClass(u.getContext(),'backdatedDot'))t.hideFlyout();});}var s={init:function(t,u){o=u;var v=[m.listenToPublish(t,p),m.listenToAnotherComposerOpen(t,p),m.listenToSetEstimatedDate(t,o.getContext.bind(o)),t.subscribeToMutate(function(){var x=!j.scry(t.root,'.cancelBtn')[0]||j.scry(t.root,'.attachmentLifeEvents')[0];if(x){o.enableBehavior(k);}else o.disableBehavior(k);}),g.subscribe('TimelineMLE/mleFlyoutShown',function(x,y){if(i.hasClass(y.getContext(),'backdatedDot')){q();}else p();}),g.subscribe(n.UPDATE_PAGE,p)],w=m.listenToCancel(o.getContent(),p);l.onLeave(function(){v.forEach(g.unsubscribe.bind(g));v=[];w.remove();w=null;});g.inform('TimelineBackdatedComposer/initialized');},getFlyout:function(){return o;}};e.exports=a.TimelineBackdatedComposer||s;});
__d("TimelineSpine",["array-extensions","event-extensions","Arbiter","AsyncRequest","Bootloader","ContextualDialogX","Composer","CSS","DOM","Layer","LayerHideOnBlur","Parent","Run","TimelineBackdatedComposer","TimelineComposerUtilities","TimelinePerfConfig","copyProperties"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Bootloader'),j=b('ContextualDialogX'),k=b('Composer'),l=b('CSS'),m=b('DOM'),n=b('Layer'),o=b('LayerHideOnBlur'),p=b('Parent'),q=b('Run'),r=b('TimelineBackdatedComposer'),s=b('TimelineComposerUtilities'),t=b('TimelinePerfConfig'),u=b('copyProperties');function v(){}u(v,{OFFSET_Y:12,composerFlyout:null,mleFlyout:null,dot:null,loadComposerFlyoutCalled:false,showComposerFlyout:function(w){var x=v.composerFlyout;if(!x){v.loadComposerFlyout(w);v.showComposerFlyoutOnLoad=true;return;}var y=m.find(x.getContent(),'div.fbTimelineBackdatedComposer'),z=k.getInstance(y);if(z){z.reset();l.removeClass(z.root,'uiComposerOpen');}x.enableBehavior(o).setContext(v.dot).updatePosition();x.show();s.hidePlaceIfAttachmentsTooTall(y);},loadComposerFlyout:function(w){if(v.loadComposerFlyoutCalled||v.composerFlyout)return;v.loadComposerFlyoutCalled=true;q.onLeave(function(){v.loadComposerFlyoutCalled=false;v.composerFlyout=null;}.bind(this));new h().setURI('/ajax/timeline/backdated_composer.php').setData({targetid:w}).setRelativeTo(v.dot||document.body).send();var x=g.subscribe('TimelineBackdatedComposer/initialized',function(){v.composerFlyout=r.getFlyout();if(v.showComposerFlyoutOnLoad)v.showComposerFlyout(w);v._handleComposerFlyoutDismissed();x.unsubscribe();});},showMLEFlyout:function(w){v.mleFlyout=w;w.setContext(v.dot).show();v.composerFlyout.hide();},_handleComposerFlyoutDismissed:function(){var w=n.subscribe('hide',function(x,y){if(v.dot&&y.getContext)if(y.getContext()===v.dot&&!v.mleFlyout){v._hideDot();}else if(y===v.mleFlyout){v.mleFlyout=null;v._hideDot();}});q.onLeave(function(){n.unsubscribe(w);}.bind(this));},_hideDot:function(){m.remove(v.dot);v.dot=null;}});u(v.prototype,{init:function(w,x){this._spine=w;if(!t.getDisableSpineHeight())this._spineHeight=w.offsetHeight;this._plus=m.find(w,'.spineHoverPlus');this._capsule=p.byClass(w,'fbTimelineCapsule');this._targetid=x;var y=[Event.listen(w,'mouseenter',function(event){v.loadComposerFlyout(this._targetid);this._spineHeight=w.offsetHeight;}.bind(this)),Event.listen(w,'mousemove',this._mouseMoved.bind(this)),Event.listen(w,'click',this._spineClicked.bind(this))];l.addClass(this._plus,'spineHoverPlusActive');q.onLeave(function(){while(y.length)y.pop().remove();}.bind(this));},_mouseMoved:function(event){var w=event.offsetY||event.layerY,x=event.getTarget();if(x!==this._spine)w=x.offsetTop+w;w=Math.min(Math.max(w-v.OFFSET_Y,0),this._spineHeight);this._plus.style.top=w+'px';},_spineClicked:function(event){if(v.mleFlyout){i.loadModules(['TimelineMLE'],function(w){w.hideFlyout();});return;}v.dot&&m.remove(v.dot);v.dot=m.create('i',{className:'backdatedDot'});v.dot.style.top=(this._plus.offsetTop-1)+'px';m.appendContent(this._spine,v.dot);event.stop();v.showComposerFlyout(this._targetid);}});e.exports=a.TimelineSpine||v;});
__d("legacy:TimelineSpine",["TimelineSpine"],function(a,b,c,d){a.TimelineSpine=b('TimelineSpine');},3);
__d("TimelineStar",["event-extensions","Button","CSS","DOM","Parent","TimelineCapsule","Tooltip","URI"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('Parent'),k=b('TimelineCapsule'),l=b('Tooltip'),m=b('URI'),n={STAR_CSS_ONLY:1,STAR_ASYNC_REQUIRED:2,ACTION_STAR:7,ACTION_UNSTAR:8,starUnitFromButton:function(o,p,q){var r=j.byClass(o,'timelineUnitContainer');n.starUnit(r,p,q);},starUnit:function(o,p,q){var r=o.parentNode;if(!q)i.setContent(r,p);h.removeClass(r,'fbTimelineTwoColumn');h.addClass(r,'fbTimelineOneColumn');r.removeAttribute('data-side');r.setAttribute('data-size','2');l.hide();k.balanceCapsule.curry(r.parentNode).defer();},unstarUnitFromButton:function(o,p,q){var r=j.byClass(o,'timelineUnitContainer');n.unstarUnit(r,p,q);},unstarUnit:function(o,p,q){var r=o.parentNode;if(!q)i.setContent(r,p);h.removeClass(r,'fbTimelineOneColumn');h.addClass(r,'fbTimelineTwoColumn');r.setAttribute('data-side','l');r.setAttribute('data-size','1');l.hide();k.balanceCapsule.curry(r.parentNode).defer();},listenToButton:function(o,p){if(!o)return;switch(p){case n.STAR_CSS_ONLY:Event.listen(o,'click',function(event){g.setEnabled(o,false);var r=j.byClass(o,'timelineUnitContainer'),s=n.unstarUnit;h.toggleClass(o,'fbTimelineStarButtonSelected');h.toggleClass(o,'selected');if(r.parentNode.getAttribute('data-size')=='1')s=n.starUnit;s(r,null,true);var t=new m(o.getAttribute('ajaxify')),u=t.getQueryData().customize_action==n.ACTION_STAR?n.ACTION_UNSTAR:n.ACTION_STAR;t.addQueryData({customize_action:u});o.setAttribute.bind(o,'ajaxify',t).defer();});var q=j.byClass(o,'stat_elem');q&&h.removeClass(q,'stat_elem');break;case n.STAR_ASYNC_REQUIRED:break;}}};e.exports=n;});
__d("OnlyMeUI",["AudienceSelector","Arbiter","CSS","DOM","Parent","PrivacyConst","Selector","$","tx"],function(a,b,c,d,e,f){var g=b('AudienceSelector'),h=b('Arbiter'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('PrivacyConst'),m=b('Selector'),n=b('$'),o=b('tx');function p(){return [j.create('div',{className:'onlyMeBorder'}),j.create('div',{className:'onlyMeBorder onlyMeBorderBottom'})];}function q(){return j.create('img',{alt:' ',className:'onlyMePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function r(x){var y=j.scry(x,'.photoUnit a.photo');return y.filter(function(z){return !j.scry(z,'.onlyMePrivacyCorner').length;});}function s(x,y){if(g.hasTags(u(y)))return;i.addClass(x,'storyOnlyMe');if(!i.hasClass(x,'timelineRecentActivityStory'))j.setContent(j.find(y,'span.uiButtonText'),"Solo yo");if(!i.hasClass(x,'storyContent')){var z=r(x);for(var aa=0,ba=z.length;aa<ba;++aa)j.appendContent(z[aa],q());}if(!j.scry(x,'div.onlyMeBorder').length){var ca=p();j.prependContent(x,ca[0]);j.appendContent(x,ca[1]);}}function t(x){if(!x)return;var y=k.byClass(x,'storyContent')||k.byClass(x,'timelineRecentActivityStory')||k.byClass(x,'timelineUnitContainer')||k.byClass(x,'fbTimelineTwoColumn');if(!y){y=j.scry(x,'^.permalink_stream .storyContent');y=y.length&&y[0];}else if(i.hasClass(y,'fbTimelineComposerUnit'))return null;return y;}function u(x){var y=j.scry(x,'*[data-oid]');if(y.length===0)return '';return y[0].getAttribute('data-oid');}var v=false,w={init:function(){if(v)return;v=true;h.subscribe('AudienceSelector/changed',function(x,y){var z=t(y.selector)||t(y.clone);if(!z)return;if(m.getOptionValue(y.option)==l.BaseValue.SELF){s(z,y.selector);}else i.removeClass(z,'storyOnlyMe');});},setOnlyMe:function(x){if(v)return;w.init();x=j.find(k.byClass(n(x),'uiSelector'),'a.uiSelectorButton');var y=t(x);y&&s(y,x);}};e.exports=w;});
__d("CountButtonCount",["ArbiterMixin","copyProperties","DOM"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('copyProperties'),i=b('DOM');function j(k,l,m){this._root=k;this._count=l;this._max=m;}h(j.prototype,g,{getCount:function(){return this._count;},setCount:function(k){this._count=k;var l=this.getDisplayedValue();i.setContent(this._root,l);this.inform('change',{value:this._count,display:l});return this;},addCount:function(k){this.setCount(this.getCount()+k);return this;},getDisplayedValue:function(){return Math.max(0,Math.min(this._count,this._max));}});e.exports=j;});
__d("CountButton",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx'),j={large:"-cx-PRIVATE-uiCountButton__counterLarge",small:"-cx-PRIVATE-uiCountButton__counterSmall",hidden:"-cx-PRIVATE-uiCountButton__counterHidden"};function k(l,m){this._root=l;this._counter=m;this._initEvents();}g(k.prototype,{_initEvents:function(){this._counter.subscribe('change',this._counterChange.bind(this));},_counterChange:function(l,m){h.removeClass(this._root,j.large);h.removeClass(this._root,j.small);h.removeClass(this._root,j.hidden);if(m.value>9){h.addClass(this._root,j.large);}else if(m.value>0){h.addClass(this._root,j.small);}else h.addClass(this._root,j.hidden);},getCounter:function(){return this._counter;}});e.exports=k;});